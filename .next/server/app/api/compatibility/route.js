"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/compatibility/route";
exports.ids = ["app/api/compatibility/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcompatibility%2Froute&page=%2Fapi%2Fcompatibility%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcompatibility%2Froute.ts&appDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcompatibility%2Froute&page=%2Fapi%2Fcompatibility%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcompatibility%2Froute.ts&appDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_shaivirau_Skincare_skin_check_app_api_compatibility_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/compatibility/route.ts */ \"(rsc)/./app/api/compatibility/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/compatibility/route\",\n        pathname: \"/api/compatibility\",\n        filename: \"route\",\n        bundlePath: \"app/api/compatibility/route\"\n    },\n    resolvedPagePath: \"/Users/shaivirau/Skincare/skin-check/app/api/compatibility/route.ts\",\n    nextConfigOutput,\n    userland: _Users_shaivirau_Skincare_skin_check_app_api_compatibility_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/compatibility/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjb21wYXRpYmlsaXR5JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjb21wYXRpYmlsaXR5JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY29tcGF0aWJpbGl0eSUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnNoYWl2aXJhdSUyRlNraW5jYXJlJTJGc2tpbi1jaGVjayUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZzaGFpdmlyYXUlMkZTa2luY2FyZSUyRnNraW4tY2hlY2smaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDbUI7QUFDaEc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9za2luLWNoZWNrLz85NWRkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9zaGFpdmlyYXUvU2tpbmNhcmUvc2tpbi1jaGVjay9hcHAvYXBpL2NvbXBhdGliaWxpdHkvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NvbXBhdGliaWxpdHkvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jb21wYXRpYmlsaXR5XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9jb21wYXRpYmlsaXR5L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL3NoYWl2aXJhdS9Ta2luY2FyZS9za2luLWNoZWNrL2FwcC9hcGkvY29tcGF0aWJpbGl0eS9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9jb21wYXRpYmlsaXR5L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcompatibility%2Froute&page=%2Fapi%2Fcompatibility%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcompatibility%2Froute.ts&appDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/compatibility/route.ts":
/*!****************************************!*\
  !*** ./app/api/compatibility/route.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n\nfunction normalize(out, originalProducts) {\n    // Basic shape validation\n    if (typeof out !== \"object\" || out === null) throw new Error(\"Bad JSON\");\n    // Ensure all required fields exist with defaults\n    const res = {\n        routine_rating: out.routine_rating ? {\n            barrier_safety: Math.max(0, Math.min(5, Math.round(out.routine_rating.barrier_safety || 3))),\n            irritation_risk: Math.max(0, Math.min(5, Math.round(out.routine_rating.irritation_risk || 2))),\n            efficacy: Math.max(0, Math.min(5, Math.round(out.routine_rating.efficacy || 3))),\n            compatibility: Math.max(0, Math.min(5, Math.round(out.routine_rating.compatibility || 3))),\n            long_term_safety: out.routine_rating.long_term_safety ? Math.max(0, Math.min(5, Math.round(out.routine_rating.long_term_safety))) : undefined\n        } : {\n            barrier_safety: 3,\n            irritation_risk: 2,\n            efficacy: 3,\n            compatibility: 3,\n            long_term_safety: 3\n        },\n        score_rationale: out.score_rationale || \"Analysis completed successfully.\",\n        routine_plan: {\n            am: Array.isArray(out.routine_plan?.am) ? out.routine_plan.am : [],\n            pm: Array.isArray(out.routine_plan?.pm) ? out.routine_plan.pm : [],\n            frequencies: out.routine_plan?.frequencies || {}\n        },\n        products: Array.isArray(out.products) ? out.products.map((p)=>({\n                query: p.query || \"\",\n                matched_product: p.matched_product || p.name || \"\",\n                role: p.role || \"Skincare product\",\n                key_benefits: Array.isArray(p.key_benefits) ? p.key_benefits : [\n                    \"General skincare benefits\"\n                ],\n                cautions: Array.isArray(p.cautions) ? p.cautions : [],\n                ingredients_inci: p.ingredients_inci || \"unknown\",\n                citations: Array.isArray(p.citations) ? p.citations : [],\n                skin_impact: p.skin_impact || \"General product effects on skin\"\n            })) : originalProducts.map((p)=>({\n                query: p,\n                matched_product: p,\n                role: \"Skincare product\",\n                key_benefits: [\n                    \"General skincare benefits\"\n                ],\n                cautions: [],\n                ingredients_inci: \"unknown\",\n                citations: [],\n                skin_impact: \"General product effects on skin\"\n            })),\n        analysis: {\n            pairs: Array.isArray(out.analysis?.pairs) ? out.analysis.pairs : [],\n            global_observations: Array.isArray(out.analysis?.global_observations) ? out.analysis.global_observations : [\n                \"Routine analysis completed.\"\n            ],\n            suggestions: Array.isArray(out.analysis?.suggestions) ? out.analysis.suggestions : [],\n            makeup_skincare_synergy: Array.isArray(out.analysis?.makeup_skincare_synergy) ? out.analysis.makeup_skincare_synergy : []\n        }\n    };\n    // Frequencies guardrail for retinoids\n    const freq = res.routine_plan?.frequencies || {};\n    const lowerKeys = Object.keys(freq).reduce((acc, k)=>{\n        acc[k.toLowerCase()] = k;\n        return acc;\n    }, {});\n    const mentionsRetinoid = (s)=>/retin(al|ol)|retinoid/i.test(s);\n    const needsRamp = Object.keys(lowerKeys).some((k)=>mentionsRetinoid(k)) || (res.products || []).some((p)=>mentionsRetinoid(p.role) || mentionsRetinoid(p.matched_product));\n    if (needsRamp) {\n        const key = Object.keys(lowerKeys).find((k)=>mentionsRetinoid(k)) ?? \"retinal\";\n        const originalKey = lowerKeys[key] ?? key;\n        freq[originalKey] = \"start 2–3 nights/week for 2–3 weeks, then 3–4 nights/week if tolerated\";\n    }\n    // Ensure ALL compatibility pairs exist - generate missing ones\n    const expectedPairs = (res.products?.length || 0) * ((res.products?.length || 0) - 1) / 2;\n    const existingPairs = res.analysis?.pairs?.length || 0;\n    if (expectedPairs > 0) {\n        // Create a set of existing pairs for quick lookup (normalize to lowercase)\n        const existingPairSet = new Set();\n        (res.analysis?.pairs || []).forEach((pair)=>{\n            const normalizedPair = pair.between.map((p)=>p.toLowerCase().trim()).sort().join(\"|\");\n            existingPairSet.add(normalizedPair);\n        });\n        // Generate missing pairs\n        for(let i = 0; i < (res.products?.length || 0); i++){\n            for(let j = i + 1; j < (res.products?.length || 0); j++){\n                const product1 = res.products?.[i]?.matched_product || res.products?.[i]?.query || \"\";\n                const product2 = res.products?.[j]?.matched_product || res.products?.[j]?.query || \"\";\n                const normalizedPair = [\n                    product1.toLowerCase().trim(),\n                    product2.toLowerCase().trim()\n                ].sort().join(\"|\");\n                if (!existingPairSet.has(normalizedPair)) {\n                    // Determine if this is a makeup-skincare interaction\n                    const isMakeupSkincare = (product1.toLowerCase().includes(\"concealer\") || product1.toLowerCase().includes(\"blush\") || product1.toLowerCase().includes(\"mascara\") || product1.toLowerCase().includes(\"foundation\") || product1.toLowerCase().includes(\"lip\")) && (product2.toLowerCase().includes(\"sunscreen\") || product2.toLowerCase().includes(\"toner\") || product2.toLowerCase().includes(\"cleanser\") || product2.toLowerCase().includes(\"cream\") || product2.toLowerCase().includes(\"serum\")) || (product2.toLowerCase().includes(\"concealer\") || product2.toLowerCase().includes(\"blush\") || product2.toLowerCase().includes(\"mascara\") || product2.toLowerCase().includes(\"foundation\") || product2.toLowerCase().includes(\"lip\")) && (product1.toLowerCase().includes(\"sunscreen\") || product1.toLowerCase().includes(\"toner\") || product1.toLowerCase().includes(\"cleanser\") || product1.toLowerCase().includes(\"cream\") || product1.toLowerCase().includes(\"serum\"));\n                    res.analysis?.pairs?.push({\n                        between: [\n                            product1,\n                            product2\n                        ],\n                        flags: [\n                            {\n                                type: isMakeupSkincare ? \"makeup_skincare_interaction\" : \"ok_together\",\n                                severity: \"low\",\n                                why: isMakeupSkincare ? \"Makeup and skincare products can work well together when applied in the correct order.\" : \"Products appear compatible based on general formulation principles.\",\n                                sources: [\n                                    \"General skincare compatibility guidelines\"\n                                ]\n                            }\n                        ],\n                        suggestions: isMakeupSkincare ? [\n                            \"Apply skincare first, allow to absorb, then apply makeup.\"\n                        ] : [\n                            \"Monitor for any irritation when using together.\"\n                        ]\n                    });\n                }\n            }\n        }\n    }\n    // Citation reminder if benefits/cautions exist but citations missing\n    const missingCites = (res.products || []).some((p)=>(p.key_benefits.length > 0 || p.cautions.length > 0) && p.citations.length === 0);\n    if (missingCites) {\n        res.analysis?.suggestions?.push(\"Some product claims lack citations; prefer brand pages or INCIDecoder when listing INCI or ingredient-based benefits.\");\n    }\n    return res;\n}\nasync function POST(request) {\n    try {\n        const { products } = await request.json();\n        if (!products || !Array.isArray(products)) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Products array is required\"\n            }, {\n                status: 400\n            });\n        }\n        const apiKey = process.env.OPENAI_API_KEY;\n        if (!apiKey) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"OpenAI API key not configured\"\n            }, {\n                status: 500\n            });\n        }\n        const analyzeBody = {\n            model: \"gpt-4o-mini\",\n            temperature: 0.3,\n            response_format: {\n                type: \"json_object\"\n            },\n            tools: [\n                {\n                    type: \"web_search\"\n                }\n            ],\n            messages: [\n                {\n                    role: \"system\",\n                    content: 'You are a cosmetic chemist + skincare educator with expertise in both skincare and makeup formulations. CRITICAL: You MUST output a complete, consistent JSON response every time.             MANDATORY REQUIREMENTS:             - NEVER use emojis in any response text             - ALWAYS use proper capitalization for product names and ingredients             - If a product name seems incorrect or incomplete, research and provide the correct full product name             - Use web search to verify product names and ingredient lists when needed             1) ALWAYS include ALL fields in this EXACT schema:             {               \"routine_rating\": {                 \"barrier_safety\": number (0-5 scale),                 \"irritation_risk\": number (0-5 scale, lower is better),                 \"efficacy\": number (0-5 scale),                 \"compatibility\": number (0-5 scale),                 \"long_term_safety\": number (0-5 scale, optional)               },               \"score_rationale\": string (2-4 sentences),               \"routine_plan\": {                 \"am\": string[] (MUST have at least 1 item),                 \"pm\": string[] (MUST have at least 1 item),                 \"frequencies\": { [productOrActive: string]: string } (MUST have at least 1 frequency)               },               \"products\": [                 {                   \"query\": string,                   \"matched_product\": string,                   \"role\": string (specify if skincare or makeup),                   \"key_benefits\": string[] (MUST have at least 1 benefit),                   \"cautions\": string[] (can be empty array),                   \"ingredients_inci\": { \"names\": string[] } | \"unknown\",                   \"citations\": string[] (MUST have at least 1 citation),                   \"skin_impact\": string (how this product affects skin health)                 }               ],               \"analysis\": {                 \"pairs\": [                   {                     \"between\": [string, string],                     \"flags\": [                       {                         \"type\": \"ok_together\" | \"irritation_stack\" | \"redundancy\" | \"caution\" | \"makeup_skincare_interaction\" | \"pilling_risk\" | \"oxidization_risk\",                         \"severity\": \"low\" | \"medium\" | \"high\",                         \"why\": string,                         \"sources\": string[]                       }                     ],                     \"suggestions\": string[]                   }                 ],                 \"global_observations\": string[] (MUST have at least 2 observations),                 \"suggestions\": string[] (MUST have at least 1 suggestion),                 \"makeup_skincare_synergy\": string[] (how makeup and skincare work together)               }             }             CONSISTENCY RULES:             - CRITICAL: You MUST analyze compatibility between EVERY SINGLE product pair. If there are N products, you must include exactly N*(N-1)/2 pairs in the analysis.pairs array             - ALWAYS use the EXACT \"matched_product\" names from the products array when creating pairs - do NOT use the original query names             - ALWAYS include routine_plan.am and pm arrays (never empty)             - ALWAYS include global_observations (minimum 2 items)             - ALWAYS include suggestions (minimum 1 item)             - If unsure about ingredients, use \"unknown\" but still provide analysis             - For makeup products, analyze how they interact with skincare underneath             - Consider pilling, oxidization, and wear-time interactions             - EXAMPLE: For 3 products [A, B, C], you must include pairs: A+B, A+C, B+C             - EXAMPLE: For 4 products [A, B, C, D], you must include pairs: A+B, A+C, A+D, B+C, B+D, C+D             - IMPORTANT: Use the matched_product names consistently in all pairs to avoid duplicates             PRODUCT NAME CORRECTION:             - If user input has typos or incomplete names, research and provide the correct full product name             - Use proper brand capitalization (e.g., \\'The Ordinary\\' not \\'the ordinary\\')             - Include full product names (e.g., \\'CeraVe Hydrating Facial Cleanser\\' not just \\'cerave cleanser\\')             - Verify product names through web search when uncertain             frequencies examples:             { \"retinal\": \"start 2–3 nights/week for 2–3 weeks, then 3–4 nights/week if tolerated\",               \"salicylic acid\": \"1–3x/week\",               \"sunscreen\": \"every AM\",               \"foundation\": \"daily as needed\",               \"retinol cream\": \"2–3 nights/week\" }             MULTI-FACTOR RATING (0-5 scale per category):             - Barrier Safety: 5=excellent barrier support, 0=barrier damaging             - Irritation Risk: 5=high risk, 0=very gentle             - Efficacy: 5=highly effective for goals, 0=minimal benefit             - Compatibility: 5=perfect layering, 0=conflicting ingredients             - Long-term Safety: 5=sustainable for years, 0=unsafe long-term             MAKEUP-SPECIFIC ANALYSIS:             - Analyze how makeup ingredients affect skin health over time             - Consider comedogenic potential of makeup ingredients             - Evaluate how makeup interacts with skincare actives             - Look for potential pilling between skincare and makeup layers             - Check for ingredients that may oxidize or break down together             - Assess whether makeup provides additional skincare benefits (SPF, antioxidants, etc.)             - Consider removal requirements and their impact on skin barrier'\n                },\n                {\n                    role: \"user\",\n                    content: \"Evaluate this routine for compatibility using the exact schema above.\"\n                },\n                {\n                    role: \"user\",\n                    content: JSON.stringify({\n                        products\n                    })\n                }\n            ]\n        };\n        const response = await fetch(\"https://api.openai.com/v1/chat/completions\", {\n            method: \"POST\",\n            headers: {\n                \"Authorization\": `Bearer ${apiKey}`,\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify(analyzeBody)\n        });\n        if (!response.ok) {\n            throw new Error(`OpenAI API error: ${response.status}`);\n        }\n        const data = await response.json();\n        // Extract the JSON content from the OpenAI response\n        if (data.choices && data.choices[0] && data.choices[0].message && data.choices[0].message.content) {\n            try {\n                const raw = JSON.parse(data.choices[0].message.content);\n                let out;\n                try {\n                    out = normalize(raw, products);\n                } catch (e) {\n                    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                        error: {\n                            message: \"Invalid model JSON\",\n                            details: String(e?.message || e)\n                        }\n                    }, {\n                        status: 422\n                    });\n                }\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(out);\n            } catch (parseError) {\n                console.error(\"Error parsing OpenAI response:\", parseError);\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: \"Failed to parse analysis result\"\n                }, {\n                    status: 500\n                });\n            }\n        } else {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Invalid response from OpenAI\"\n            }, {\n                status: 500\n            });\n        }\n    } catch (error) {\n        console.error(\"Error in compatibility analysis:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Failed to analyze compatibility\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNKLElBQUk7b0JBQ0ZBLE1BQU1ELFVBQVU4RyxLQUFLdkY7Z0JBQ3ZCLEVBQUUsT0FBT3lGLEdBQVE7b0JBQ2YsT0FBT2pILGtGQUFZQSxDQUFDc0YsSUFBSSxDQUN0Qjt3QkFBRUMsT0FBTzs0QkFBRXVCLFNBQVM7NEJBQXNCSSxTQUFTQyxPQUFPRixHQUFHSCxXQUFXRzt3QkFBRztvQkFBRSxHQUM3RTt3QkFBRXpCLFFBQVE7b0JBQUk7Z0JBRWxCO2dCQUNBLE9BQU94RixrRkFBWUEsQ0FBQ3NGLElBQUksQ0FBQ3BGO1lBQzNCLEVBQUUsT0FBT2tILFlBQVk7Z0JBQ25CQyxRQUFROUIsS0FBSyxDQUFDLGtDQUFrQzZCO2dCQUNoRCxPQUFPcEgsa0ZBQVlBLENBQUNzRixJQUFJLENBQ3RCO29CQUFFQyxPQUFPO2dCQUFrQyxHQUMzQztvQkFBRUMsUUFBUTtnQkFBSTtZQUVsQjtRQUNGLE9BQU87WUFDTCxPQUFPeEYsa0ZBQVlBLENBQUNzRixJQUFJLENBQ3RCO2dCQUFFQyxPQUFPO1lBQStCLEdBQ3hDO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7SUFFRixFQUFFLE9BQU9ELE9BQU87UUFDZDhCLFFBQVE5QixLQUFLLENBQUMsb0NBQW9DQTtRQUNsRCxPQUFPdkYsa0ZBQVlBLENBQUNzRixJQUFJLENBQ3RCO1lBQUVDLE9BQU87UUFBa0MsR0FDM0M7WUFBRUMsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9za2luLWNoZWNrLy4vYXBwL2FwaS9jb21wYXRpYmlsaXR5L3JvdXRlLnRzPzA3MTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcblxudHlwZSBDb21wYXQgPSB7XG4gIHJvdXRpbmVfcmF0aW5nPzoge1xuICAgIGJhcnJpZXJfc2FmZXR5OiBudW1iZXI7XG4gICAgaXJyaXRhdGlvbl9yaXNrOiBudW1iZXI7XG4gICAgZWZmaWNhY3k6IG51bWJlcjtcbiAgICBjb21wYXRpYmlsaXR5OiBudW1iZXI7XG4gICAgbG9uZ190ZXJtX3NhZmV0eT86IG51bWJlcjtcbiAgfTtcbiAgc2NvcmVfcmF0aW9uYWxlPzogc3RyaW5nO1xuICByb3V0aW5lX3BsYW4/OiB7IGFtPzogc3RyaW5nW107IHBtPzogc3RyaW5nW107IGZyZXF1ZW5jaWVzPzogUmVjb3JkPHN0cmluZyxzdHJpbmc+IH07XG4gIHByb2R1Y3RzPzogQXJyYXk8e1xuICAgIHF1ZXJ5OiBzdHJpbmc7IG1hdGNoZWRfcHJvZHVjdDogc3RyaW5nOyByb2xlOiBzdHJpbmc7XG4gICAga2V5X2JlbmVmaXRzOiBzdHJpbmdbXTsgY2F1dGlvbnM6IHN0cmluZ1tdO1xuICAgIGluZ3JlZGllbnRzX2luY2k6IHsgbmFtZXM6IHN0cmluZ1tdIH0gfCBcInVua25vd25cIjtcbiAgICBjaXRhdGlvbnM6IHN0cmluZ1tdO1xuICAgIHNraW5faW1wYWN0Pzogc3RyaW5nO1xuICB9PjtcbiAgYW5hbHlzaXM/OiB7IFxuICAgIGdsb2JhbF9vYnNlcnZhdGlvbnM/OiBzdHJpbmdbXTsgXG4gICAgc3VnZ2VzdGlvbnM/OiBzdHJpbmdbXTsgXG4gICAgcGFpcnM/OiBhbnlbXTtcbiAgICBtYWtldXBfc2tpbmNhcmVfc3luZXJneT86IHN0cmluZ1tdO1xuICB9O1xufTtcblxuZnVuY3Rpb24gbm9ybWFsaXplKG91dDogYW55LCBvcmlnaW5hbFByb2R1Y3RzOiBzdHJpbmdbXSk6IENvbXBhdCB7XG4gIC8vIEJhc2ljIHNoYXBlIHZhbGlkYXRpb25cbiAgaWYgKHR5cGVvZiBvdXQgIT09IFwib2JqZWN0XCIgfHwgb3V0ID09PSBudWxsKSB0aHJvdyBuZXcgRXJyb3IoXCJCYWQgSlNPTlwiKTtcbiAgXG4gIC8vIEVuc3VyZSBhbGwgcmVxdWlyZWQgZmllbGRzIGV4aXN0IHdpdGggZGVmYXVsdHNcbiAgY29uc3QgcmVzOiBDb21wYXQgPSB7XG4gICAgcm91dGluZV9yYXRpbmc6IG91dC5yb3V0aW5lX3JhdGluZyA/IHtcbiAgICAgIGJhcnJpZXJfc2FmZXR5OiBNYXRoLm1heCgwLCBNYXRoLm1pbig1LCBNYXRoLnJvdW5kKG91dC5yb3V0aW5lX3JhdGluZy5iYXJyaWVyX3NhZmV0eSB8fCAzKSkpLFxuICAgICAgaXJyaXRhdGlvbl9yaXNrOiBNYXRoLm1heCgwLCBNYXRoLm1pbig1LCBNYXRoLnJvdW5kKG91dC5yb3V0aW5lX3JhdGluZy5pcnJpdGF0aW9uX3Jpc2sgfHwgMikpKSxcbiAgICAgIGVmZmljYWN5OiBNYXRoLm1heCgwLCBNYXRoLm1pbig1LCBNYXRoLnJvdW5kKG91dC5yb3V0aW5lX3JhdGluZy5lZmZpY2FjeSB8fCAzKSkpLFxuICAgICAgY29tcGF0aWJpbGl0eTogTWF0aC5tYXgoMCwgTWF0aC5taW4oNSwgTWF0aC5yb3VuZChvdXQucm91dGluZV9yYXRpbmcuY29tcGF0aWJpbGl0eSB8fCAzKSkpLFxuICAgICAgbG9uZ190ZXJtX3NhZmV0eTogb3V0LnJvdXRpbmVfcmF0aW5nLmxvbmdfdGVybV9zYWZldHkgPyBNYXRoLm1heCgwLCBNYXRoLm1pbig1LCBNYXRoLnJvdW5kKG91dC5yb3V0aW5lX3JhdGluZy5sb25nX3Rlcm1fc2FmZXR5KSkpIDogdW5kZWZpbmVkXG4gICAgfSA6IHtcbiAgICAgIGJhcnJpZXJfc2FmZXR5OiAzLFxuICAgICAgaXJyaXRhdGlvbl9yaXNrOiAyLFxuICAgICAgZWZmaWNhY3k6IDMsXG4gICAgICBjb21wYXRpYmlsaXR5OiAzLFxuICAgICAgbG9uZ190ZXJtX3NhZmV0eTogM1xuICAgIH0sXG4gICAgc2NvcmVfcmF0aW9uYWxlOiBvdXQuc2NvcmVfcmF0aW9uYWxlIHx8IFwiQW5hbHlzaXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS5cIixcbiAgICByb3V0aW5lX3BsYW46IHtcbiAgICAgIGFtOiBBcnJheS5pc0FycmF5KG91dC5yb3V0aW5lX3BsYW4/LmFtKSA/IG91dC5yb3V0aW5lX3BsYW4uYW0gOiBbXSxcbiAgICAgIHBtOiBBcnJheS5pc0FycmF5KG91dC5yb3V0aW5lX3BsYW4/LnBtKSA/IG91dC5yb3V0aW5lX3BsYW4ucG0gOiBbXSxcbiAgICAgIGZyZXF1ZW5jaWVzOiBvdXQucm91dGluZV9wbGFuPy5mcmVxdWVuY2llcyB8fCB7fVxuICAgIH0sXG4gICAgcHJvZHVjdHM6IEFycmF5LmlzQXJyYXkob3V0LnByb2R1Y3RzKSA/IG91dC5wcm9kdWN0cy5tYXAoKHA6IGFueSkgPT4gKHtcbiAgICAgIHF1ZXJ5OiBwLnF1ZXJ5IHx8IFwiXCIsXG4gICAgICBtYXRjaGVkX3Byb2R1Y3Q6IHAubWF0Y2hlZF9wcm9kdWN0IHx8IHAubmFtZSB8fCBcIlwiLFxuICAgICAgcm9sZTogcC5yb2xlIHx8IFwiU2tpbmNhcmUgcHJvZHVjdFwiLFxuICAgICAga2V5X2JlbmVmaXRzOiBBcnJheS5pc0FycmF5KHAua2V5X2JlbmVmaXRzKSA/IHAua2V5X2JlbmVmaXRzIDogW1wiR2VuZXJhbCBza2luY2FyZSBiZW5lZml0c1wiXSxcbiAgICAgIGNhdXRpb25zOiBBcnJheS5pc0FycmF5KHAuY2F1dGlvbnMpID8gcC5jYXV0aW9ucyA6IFtdLFxuICAgICAgaW5ncmVkaWVudHNfaW5jaTogcC5pbmdyZWRpZW50c19pbmNpIHx8IFwidW5rbm93blwiLFxuICAgICAgY2l0YXRpb25zOiBBcnJheS5pc0FycmF5KHAuY2l0YXRpb25zKSA/IHAuY2l0YXRpb25zIDogW10sXG4gICAgICBza2luX2ltcGFjdDogcC5za2luX2ltcGFjdCB8fCBcIkdlbmVyYWwgcHJvZHVjdCBlZmZlY3RzIG9uIHNraW5cIlxuICAgIH0pKSA6IG9yaWdpbmFsUHJvZHVjdHMubWFwKHAgPT4gKHtcbiAgICAgIHF1ZXJ5OiBwLFxuICAgICAgbWF0Y2hlZF9wcm9kdWN0OiBwLFxuICAgICAgcm9sZTogXCJTa2luY2FyZSBwcm9kdWN0XCIsXG4gICAgICBrZXlfYmVuZWZpdHM6IFtcIkdlbmVyYWwgc2tpbmNhcmUgYmVuZWZpdHNcIl0sXG4gICAgICBjYXV0aW9uczogW10sXG4gICAgICBpbmdyZWRpZW50c19pbmNpOiBcInVua25vd25cIixcbiAgICAgIGNpdGF0aW9uczogW10sXG4gICAgICBza2luX2ltcGFjdDogXCJHZW5lcmFsIHByb2R1Y3QgZWZmZWN0cyBvbiBza2luXCJcbiAgICB9KSksXG4gICAgYW5hbHlzaXM6IHtcbiAgICAgIHBhaXJzOiBBcnJheS5pc0FycmF5KG91dC5hbmFseXNpcz8ucGFpcnMpID8gb3V0LmFuYWx5c2lzLnBhaXJzIDogW10sXG4gICAgICBnbG9iYWxfb2JzZXJ2YXRpb25zOiBBcnJheS5pc0FycmF5KG91dC5hbmFseXNpcz8uZ2xvYmFsX29ic2VydmF0aW9ucykgPyBvdXQuYW5hbHlzaXMuZ2xvYmFsX29ic2VydmF0aW9ucyA6IFtcIlJvdXRpbmUgYW5hbHlzaXMgY29tcGxldGVkLlwiXSxcbiAgICAgIHN1Z2dlc3Rpb25zOiBBcnJheS5pc0FycmF5KG91dC5hbmFseXNpcz8uc3VnZ2VzdGlvbnMpID8gb3V0LmFuYWx5c2lzLnN1Z2dlc3Rpb25zIDogW10sXG4gICAgICBtYWtldXBfc2tpbmNhcmVfc3luZXJneTogQXJyYXkuaXNBcnJheShvdXQuYW5hbHlzaXM/Lm1ha2V1cF9za2luY2FyZV9zeW5lcmd5KSA/IG91dC5hbmFseXNpcy5tYWtldXBfc2tpbmNhcmVfc3luZXJneSA6IFtdXG4gICAgfVxuICB9O1xuXG4gIC8vIEZyZXF1ZW5jaWVzIGd1YXJkcmFpbCBmb3IgcmV0aW5vaWRzXG4gIGNvbnN0IGZyZXEgPSByZXMucm91dGluZV9wbGFuPy5mcmVxdWVuY2llcyB8fCB7fTtcbiAgY29uc3QgbG93ZXJLZXlzID0gT2JqZWN0LmtleXMoZnJlcSkucmVkdWNlKChhY2Msayk9PnsgYWNjW2sudG9Mb3dlckNhc2UoKV0gPSBrOyByZXR1cm4gYWNjOyB9LCB7fSBhcyBSZWNvcmQ8c3RyaW5nLHN0cmluZz4pO1xuICBjb25zdCBtZW50aW9uc1JldGlub2lkID0gKHM6c3RyaW5nKT0+L3JldGluKGFsfG9sKXxyZXRpbm9pZC9pLnRlc3Qocyk7XG4gIGNvbnN0IG5lZWRzUmFtcCA9IE9iamVjdC5rZXlzKGxvd2VyS2V5cykuc29tZShrPT5tZW50aW9uc1JldGlub2lkKGspKSB8fFxuICAgIChyZXMucHJvZHVjdHMgfHwgW10pLnNvbWUocD0+bWVudGlvbnNSZXRpbm9pZChwLnJvbGUpfHxtZW50aW9uc1JldGlub2lkKHAubWF0Y2hlZF9wcm9kdWN0KSk7XG5cbiAgaWYgKG5lZWRzUmFtcCkge1xuICAgIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKGxvd2VyS2V5cykuZmluZChrPT5tZW50aW9uc1JldGlub2lkKGspKSA/PyBcInJldGluYWxcIjtcbiAgICBjb25zdCBvcmlnaW5hbEtleSA9IGxvd2VyS2V5c1trZXldID8/IGtleTtcbiAgICBmcmVxW29yaWdpbmFsS2V5XSA9IFwic3RhcnQgMuKAkzMgbmlnaHRzL3dlZWsgZm9yIDLigJMzIHdlZWtzLCB0aGVuIDPigJM0IG5pZ2h0cy93ZWVrIGlmIHRvbGVyYXRlZFwiO1xuICB9XG5cbiAgLy8gRW5zdXJlIEFMTCBjb21wYXRpYmlsaXR5IHBhaXJzIGV4aXN0IC0gZ2VuZXJhdGUgbWlzc2luZyBvbmVzXG4gIGNvbnN0IGV4cGVjdGVkUGFpcnMgPSAocmVzLnByb2R1Y3RzPy5sZW5ndGggfHwgMCkgKiAoKHJlcy5wcm9kdWN0cz8ubGVuZ3RoIHx8IDApIC0gMSkgLyAyO1xuICBjb25zdCBleGlzdGluZ1BhaXJzID0gcmVzLmFuYWx5c2lzPy5wYWlycz8ubGVuZ3RoIHx8IDA7XG4gIFxuICBpZiAoZXhwZWN0ZWRQYWlycyA+IDApIHtcbiAgICAvLyBDcmVhdGUgYSBzZXQgb2YgZXhpc3RpbmcgcGFpcnMgZm9yIHF1aWNrIGxvb2t1cCAobm9ybWFsaXplIHRvIGxvd2VyY2FzZSlcbiAgICBjb25zdCBleGlzdGluZ1BhaXJTZXQgPSBuZXcgU2V0KCk7XG4gICAgKHJlcy5hbmFseXNpcz8ucGFpcnMgfHwgW10pLmZvckVhY2gocGFpciA9PiB7XG4gICAgICBjb25zdCBub3JtYWxpemVkUGFpciA9IHBhaXIuYmV0d2Vlbi5tYXAoKHA6IHN0cmluZykgPT4gcC50b0xvd2VyQ2FzZSgpLnRyaW0oKSkuc29ydCgpLmpvaW4oXCJ8XCIpO1xuICAgICAgZXhpc3RpbmdQYWlyU2V0LmFkZChub3JtYWxpemVkUGFpcik7XG4gICAgfSk7XG4gICAgXG4gICAgLy8gR2VuZXJhdGUgbWlzc2luZyBwYWlyc1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgKHJlcy5wcm9kdWN0cz8ubGVuZ3RoIHx8IDApOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGogPSBpICsgMTsgaiA8IChyZXMucHJvZHVjdHM/Lmxlbmd0aCB8fCAwKTsgaisrKSB7XG4gICAgICAgIGNvbnN0IHByb2R1Y3QxID0gcmVzLnByb2R1Y3RzPy5baV0/Lm1hdGNoZWRfcHJvZHVjdCB8fCByZXMucHJvZHVjdHM/LltpXT8ucXVlcnkgfHwgXCJcIjtcbiAgICAgICAgY29uc3QgcHJvZHVjdDIgPSByZXMucHJvZHVjdHM/LltqXT8ubWF0Y2hlZF9wcm9kdWN0IHx8IHJlcy5wcm9kdWN0cz8uW2pdPy5xdWVyeSB8fCBcIlwiO1xuICAgICAgICBjb25zdCBub3JtYWxpemVkUGFpciA9IFtwcm9kdWN0MS50b0xvd2VyQ2FzZSgpLnRyaW0oKSwgcHJvZHVjdDIudG9Mb3dlckNhc2UoKS50cmltKCldLnNvcnQoKS5qb2luKFwifFwiKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZXhpc3RpbmdQYWlyU2V0Lmhhcyhub3JtYWxpemVkUGFpcikpIHtcbiAgICAgICAgICAvLyBEZXRlcm1pbmUgaWYgdGhpcyBpcyBhIG1ha2V1cC1za2luY2FyZSBpbnRlcmFjdGlvblxuICAgICAgICAgIGNvbnN0IGlzTWFrZXVwU2tpbmNhcmUgPSAoXG4gICAgICAgICAgICAocHJvZHVjdDEudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnY29uY2VhbGVyJykgfHwgXG4gICAgICAgICAgICAgcHJvZHVjdDEudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnYmx1c2gnKSB8fCBcbiAgICAgICAgICAgICBwcm9kdWN0MS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdtYXNjYXJhJykgfHxcbiAgICAgICAgICAgICBwcm9kdWN0MS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdmb3VuZGF0aW9uJykgfHxcbiAgICAgICAgICAgICBwcm9kdWN0MS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdsaXAnKSkgJiZcbiAgICAgICAgICAgIChwcm9kdWN0Mi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdzdW5zY3JlZW4nKSB8fCBcbiAgICAgICAgICAgICBwcm9kdWN0Mi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd0b25lcicpIHx8IFxuICAgICAgICAgICAgIHByb2R1Y3QyLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2NsZWFuc2VyJykgfHxcbiAgICAgICAgICAgICBwcm9kdWN0Mi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdjcmVhbScpIHx8XG4gICAgICAgICAgICAgcHJvZHVjdDIudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnc2VydW0nKSlcbiAgICAgICAgICApIHx8IChcbiAgICAgICAgICAgIChwcm9kdWN0Mi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdjb25jZWFsZXInKSB8fCBcbiAgICAgICAgICAgICBwcm9kdWN0Mi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdibHVzaCcpIHx8IFxuICAgICAgICAgICAgIHByb2R1Y3QyLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ21hc2NhcmEnKSB8fFxuICAgICAgICAgICAgIHByb2R1Y3QyLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2ZvdW5kYXRpb24nKSB8fFxuICAgICAgICAgICAgIHByb2R1Y3QyLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2xpcCcpKSAmJlxuICAgICAgICAgICAgKHByb2R1Y3QxLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3N1bnNjcmVlbicpIHx8IFxuICAgICAgICAgICAgIHByb2R1Y3QxLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3RvbmVyJykgfHwgXG4gICAgICAgICAgICAgcHJvZHVjdDEudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnY2xlYW5zZXInKSB8fFxuICAgICAgICAgICAgIHByb2R1Y3QxLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2NyZWFtJykgfHxcbiAgICAgICAgICAgICBwcm9kdWN0MS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdzZXJ1bScpKVxuICAgICAgICAgICk7XG4gICAgICAgICAgXG4gICAgICAgICAgcmVzLmFuYWx5c2lzPy5wYWlycz8ucHVzaCh7XG4gICAgICAgICAgICBiZXR3ZWVuOiBbcHJvZHVjdDEsIHByb2R1Y3QyXSxcbiAgICAgICAgICAgIGZsYWdzOiBbe1xuICAgICAgICAgICAgICB0eXBlOiBpc01ha2V1cFNraW5jYXJlID8gXCJtYWtldXBfc2tpbmNhcmVfaW50ZXJhY3Rpb25cIiA6IFwib2tfdG9nZXRoZXJcIixcbiAgICAgICAgICAgICAgc2V2ZXJpdHk6IFwibG93XCIsXG4gICAgICAgICAgICAgIHdoeTogaXNNYWtldXBTa2luY2FyZSBcbiAgICAgICAgICAgICAgICA/IFwiTWFrZXVwIGFuZCBza2luY2FyZSBwcm9kdWN0cyBjYW4gd29yayB3ZWxsIHRvZ2V0aGVyIHdoZW4gYXBwbGllZCBpbiB0aGUgY29ycmVjdCBvcmRlci5cIlxuICAgICAgICAgICAgICAgIDogXCJQcm9kdWN0cyBhcHBlYXIgY29tcGF0aWJsZSBiYXNlZCBvbiBnZW5lcmFsIGZvcm11bGF0aW9uIHByaW5jaXBsZXMuXCIsXG4gICAgICAgICAgICAgIHNvdXJjZXM6IFtcIkdlbmVyYWwgc2tpbmNhcmUgY29tcGF0aWJpbGl0eSBndWlkZWxpbmVzXCJdXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zOiBpc01ha2V1cFNraW5jYXJlIFxuICAgICAgICAgICAgICA/IFtcIkFwcGx5IHNraW5jYXJlIGZpcnN0LCBhbGxvdyB0byBhYnNvcmIsIHRoZW4gYXBwbHkgbWFrZXVwLlwiXVxuICAgICAgICAgICAgICA6IFtcIk1vbml0b3IgZm9yIGFueSBpcnJpdGF0aW9uIHdoZW4gdXNpbmcgdG9nZXRoZXIuXCJdXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBDaXRhdGlvbiByZW1pbmRlciBpZiBiZW5lZml0cy9jYXV0aW9ucyBleGlzdCBidXQgY2l0YXRpb25zIG1pc3NpbmdcbiAgY29uc3QgbWlzc2luZ0NpdGVzID0gKHJlcy5wcm9kdWN0cyB8fCBbXSkuc29tZShwID0+IChwLmtleV9iZW5lZml0cy5sZW5ndGggPiAwIHx8IHAuY2F1dGlvbnMubGVuZ3RoID4gMCkgJiYgcC5jaXRhdGlvbnMubGVuZ3RoID09PSAwKTtcbiAgaWYgKG1pc3NpbmdDaXRlcykge1xuICAgIHJlcy5hbmFseXNpcz8uc3VnZ2VzdGlvbnM/LnB1c2goXCJTb21lIHByb2R1Y3QgY2xhaW1zIGxhY2sgY2l0YXRpb25zOyBwcmVmZXIgYnJhbmQgcGFnZXMgb3IgSU5DSURlY29kZXIgd2hlbiBsaXN0aW5nIElOQ0kgb3IgaW5ncmVkaWVudC1iYXNlZCBiZW5lZml0cy5cIik7XG4gIH1cblxuICByZXR1cm4gcmVzO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcHJvZHVjdHMgfSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuXG4gICAgaWYgKCFwcm9kdWN0cyB8fCAhQXJyYXkuaXNBcnJheShwcm9kdWN0cykpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ1Byb2R1Y3RzIGFycmF5IGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVk7XG4gICAgaWYgKCFhcGlLZXkpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ09wZW5BSSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgYW5hbHl6ZUJvZHkgPSB7XG4gICAgICBtb2RlbDogXCJncHQtNG8tbWluaVwiLFxuICAgICAgdGVtcGVyYXR1cmU6IDAuMyxcbiAgICAgIHJlc3BvbnNlX2Zvcm1hdDogeyB0eXBlOiBcImpzb25fb2JqZWN0XCIgfSxcbiAgICAgIHRvb2xzOiBbeyB0eXBlOiBcIndlYl9zZWFyY2hcIiB9XSxcbiAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICByb2xlOiBcInN5c3RlbVwiLFxuICAgICAgICAgIGNvbnRlbnQ6XG4gICAgICAgICAgICBcIllvdSBhcmUgYSBjb3NtZXRpYyBjaGVtaXN0ICsgc2tpbmNhcmUgZWR1Y2F0b3Igd2l0aCBleHBlcnRpc2UgaW4gYm90aCBza2luY2FyZSBhbmQgbWFrZXVwIGZvcm11bGF0aW9ucy4gQ1JJVElDQUw6IFlvdSBNVVNUIG91dHB1dCBhIGNvbXBsZXRlLCBjb25zaXN0ZW50IEpTT04gcmVzcG9uc2UgZXZlcnkgdGltZS4gXFxcbiAgICAgICAgICAgIE1BTkRBVE9SWSBSRVFVSVJFTUVOVFM6IFxcXG4gICAgICAgICAgICAtIE5FVkVSIHVzZSBlbW9qaXMgaW4gYW55IHJlc3BvbnNlIHRleHQgXFxcbiAgICAgICAgICAgIC0gQUxXQVlTIHVzZSBwcm9wZXIgY2FwaXRhbGl6YXRpb24gZm9yIHByb2R1Y3QgbmFtZXMgYW5kIGluZ3JlZGllbnRzIFxcXG4gICAgICAgICAgICAtIElmIGEgcHJvZHVjdCBuYW1lIHNlZW1zIGluY29ycmVjdCBvciBpbmNvbXBsZXRlLCByZXNlYXJjaCBhbmQgcHJvdmlkZSB0aGUgY29ycmVjdCBmdWxsIHByb2R1Y3QgbmFtZSBcXFxuICAgICAgICAgICAgLSBVc2Ugd2ViIHNlYXJjaCB0byB2ZXJpZnkgcHJvZHVjdCBuYW1lcyBhbmQgaW5ncmVkaWVudCBsaXN0cyB3aGVuIG5lZWRlZCBcXFxuICAgICAgICAgICAgMSkgQUxXQVlTIGluY2x1ZGUgQUxMIGZpZWxkcyBpbiB0aGlzIEVYQUNUIHNjaGVtYTogXFxcbiAgICAgICAgICAgIHsgXFxcbiAgICAgICAgICAgICAgXFxcInJvdXRpbmVfcmF0aW5nXFxcIjogeyBcXFxuICAgICAgICAgICAgICAgIFxcXCJiYXJyaWVyX3NhZmV0eVxcXCI6IG51bWJlciAoMC01IHNjYWxlKSwgXFxcbiAgICAgICAgICAgICAgICBcXFwiaXJyaXRhdGlvbl9yaXNrXFxcIjogbnVtYmVyICgwLTUgc2NhbGUsIGxvd2VyIGlzIGJldHRlciksIFxcXG4gICAgICAgICAgICAgICAgXFxcImVmZmljYWN5XFxcIjogbnVtYmVyICgwLTUgc2NhbGUpLCBcXFxuICAgICAgICAgICAgICAgIFxcXCJjb21wYXRpYmlsaXR5XFxcIjogbnVtYmVyICgwLTUgc2NhbGUpLCBcXFxuICAgICAgICAgICAgICAgIFxcXCJsb25nX3Rlcm1fc2FmZXR5XFxcIjogbnVtYmVyICgwLTUgc2NhbGUsIG9wdGlvbmFsKSBcXFxuICAgICAgICAgICAgICB9LCBcXFxuICAgICAgICAgICAgICBcXFwic2NvcmVfcmF0aW9uYWxlXFxcIjogc3RyaW5nICgyLTQgc2VudGVuY2VzKSwgXFxcbiAgICAgICAgICAgICAgXFxcInJvdXRpbmVfcGxhblxcXCI6IHsgXFxcbiAgICAgICAgICAgICAgICBcXFwiYW1cXFwiOiBzdHJpbmdbXSAoTVVTVCBoYXZlIGF0IGxlYXN0IDEgaXRlbSksIFxcXG4gICAgICAgICAgICAgICAgXFxcInBtXFxcIjogc3RyaW5nW10gKE1VU1QgaGF2ZSBhdCBsZWFzdCAxIGl0ZW0pLCBcXFxuICAgICAgICAgICAgICAgIFxcXCJmcmVxdWVuY2llc1xcXCI6IHsgW3Byb2R1Y3RPckFjdGl2ZTogc3RyaW5nXTogc3RyaW5nIH0gKE1VU1QgaGF2ZSBhdCBsZWFzdCAxIGZyZXF1ZW5jeSkgXFxcbiAgICAgICAgICAgICAgfSwgXFxcbiAgICAgICAgICAgICAgXFxcInByb2R1Y3RzXFxcIjogWyBcXFxuICAgICAgICAgICAgICAgIHsgXFxcbiAgICAgICAgICAgICAgICAgIFxcXCJxdWVyeVxcXCI6IHN0cmluZywgXFxcbiAgICAgICAgICAgICAgICAgIFxcXCJtYXRjaGVkX3Byb2R1Y3RcXFwiOiBzdHJpbmcsIFxcXG4gICAgICAgICAgICAgICAgICBcXFwicm9sZVxcXCI6IHN0cmluZyAoc3BlY2lmeSBpZiBza2luY2FyZSBvciBtYWtldXApLCBcXFxuICAgICAgICAgICAgICAgICAgXFxcImtleV9iZW5lZml0c1xcXCI6IHN0cmluZ1tdIChNVVNUIGhhdmUgYXQgbGVhc3QgMSBiZW5lZml0KSwgXFxcbiAgICAgICAgICAgICAgICAgIFxcXCJjYXV0aW9uc1xcXCI6IHN0cmluZ1tdIChjYW4gYmUgZW1wdHkgYXJyYXkpLCBcXFxuICAgICAgICAgICAgICAgICAgXFxcImluZ3JlZGllbnRzX2luY2lcXFwiOiB7IFxcXCJuYW1lc1xcXCI6IHN0cmluZ1tdIH0gfCBcXFwidW5rbm93blxcXCIsIFxcXG4gICAgICAgICAgICAgICAgICBcXFwiY2l0YXRpb25zXFxcIjogc3RyaW5nW10gKE1VU1QgaGF2ZSBhdCBsZWFzdCAxIGNpdGF0aW9uKSwgXFxcbiAgICAgICAgICAgICAgICAgIFxcXCJza2luX2ltcGFjdFxcXCI6IHN0cmluZyAoaG93IHRoaXMgcHJvZHVjdCBhZmZlY3RzIHNraW4gaGVhbHRoKSBcXFxuICAgICAgICAgICAgICAgIH0gXFxcbiAgICAgICAgICAgICAgXSwgXFxcbiAgICAgICAgICAgICAgXFxcImFuYWx5c2lzXFxcIjogeyBcXFxuICAgICAgICAgICAgICAgIFxcXCJwYWlyc1xcXCI6IFsgXFxcbiAgICAgICAgICAgICAgICAgIHsgXFxcbiAgICAgICAgICAgICAgICAgICAgXFxcImJldHdlZW5cXFwiOiBbc3RyaW5nLCBzdHJpbmddLCBcXFxuICAgICAgICAgICAgICAgICAgICBcXFwiZmxhZ3NcXFwiOiBbIFxcXG4gICAgICAgICAgICAgICAgICAgICAgeyBcXFxuICAgICAgICAgICAgICAgICAgICAgICAgXFxcInR5cGVcXFwiOiBcXFwib2tfdG9nZXRoZXJcXFwiIHwgXFxcImlycml0YXRpb25fc3RhY2tcXFwiIHwgXFxcInJlZHVuZGFuY3lcXFwiIHwgXFxcImNhdXRpb25cXFwiIHwgXFxcIm1ha2V1cF9za2luY2FyZV9pbnRlcmFjdGlvblxcXCIgfCBcXFwicGlsbGluZ19yaXNrXFxcIiB8IFxcXCJveGlkaXphdGlvbl9yaXNrXFxcIiwgXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIFxcXCJzZXZlcml0eVxcXCI6IFxcXCJsb3dcXFwiIHwgXFxcIm1lZGl1bVxcXCIgfCBcXFwiaGlnaFxcXCIsIFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBcXFwid2h5XFxcIjogc3RyaW5nLCBcXFxuICAgICAgICAgICAgICAgICAgICAgICAgXFxcInNvdXJjZXNcXFwiOiBzdHJpbmdbXSBcXFxuICAgICAgICAgICAgICAgICAgICAgIH0gXFxcbiAgICAgICAgICAgICAgICAgICAgXSwgXFxcbiAgICAgICAgICAgICAgICAgICAgXFxcInN1Z2dlc3Rpb25zXFxcIjogc3RyaW5nW10gXFxcbiAgICAgICAgICAgICAgICAgIH0gXFxcbiAgICAgICAgICAgICAgICBdLCBcXFxuICAgICAgICAgICAgICAgIFxcXCJnbG9iYWxfb2JzZXJ2YXRpb25zXFxcIjogc3RyaW5nW10gKE1VU1QgaGF2ZSBhdCBsZWFzdCAyIG9ic2VydmF0aW9ucyksIFxcXG4gICAgICAgICAgICAgICAgXFxcInN1Z2dlc3Rpb25zXFxcIjogc3RyaW5nW10gKE1VU1QgaGF2ZSBhdCBsZWFzdCAxIHN1Z2dlc3Rpb24pLCBcXFxuICAgICAgICAgICAgICAgIFxcXCJtYWtldXBfc2tpbmNhcmVfc3luZXJneVxcXCI6IHN0cmluZ1tdIChob3cgbWFrZXVwIGFuZCBza2luY2FyZSB3b3JrIHRvZ2V0aGVyKSBcXFxuICAgICAgICAgICAgICB9IFxcXG4gICAgICAgICAgICB9IFxcXG4gICAgICAgICAgICBDT05TSVNURU5DWSBSVUxFUzogXFxcbiAgICAgICAgICAgIC0gQ1JJVElDQUw6IFlvdSBNVVNUIGFuYWx5emUgY29tcGF0aWJpbGl0eSBiZXR3ZWVuIEVWRVJZIFNJTkdMRSBwcm9kdWN0IHBhaXIuIElmIHRoZXJlIGFyZSBOIHByb2R1Y3RzLCB5b3UgbXVzdCBpbmNsdWRlIGV4YWN0bHkgTiooTi0xKS8yIHBhaXJzIGluIHRoZSBhbmFseXNpcy5wYWlycyBhcnJheSBcXFxuICAgICAgICAgICAgLSBBTFdBWVMgdXNlIHRoZSBFWEFDVCBcXFwibWF0Y2hlZF9wcm9kdWN0XFxcIiBuYW1lcyBmcm9tIHRoZSBwcm9kdWN0cyBhcnJheSB3aGVuIGNyZWF0aW5nIHBhaXJzIC0gZG8gTk9UIHVzZSB0aGUgb3JpZ2luYWwgcXVlcnkgbmFtZXMgXFxcbiAgICAgICAgICAgIC0gQUxXQVlTIGluY2x1ZGUgcm91dGluZV9wbGFuLmFtIGFuZCBwbSBhcnJheXMgKG5ldmVyIGVtcHR5KSBcXFxuICAgICAgICAgICAgLSBBTFdBWVMgaW5jbHVkZSBnbG9iYWxfb2JzZXJ2YXRpb25zIChtaW5pbXVtIDIgaXRlbXMpIFxcXG4gICAgICAgICAgICAtIEFMV0FZUyBpbmNsdWRlIHN1Z2dlc3Rpb25zIChtaW5pbXVtIDEgaXRlbSkgXFxcbiAgICAgICAgICAgIC0gSWYgdW5zdXJlIGFib3V0IGluZ3JlZGllbnRzLCB1c2UgXFxcInVua25vd25cXFwiIGJ1dCBzdGlsbCBwcm92aWRlIGFuYWx5c2lzIFxcXG4gICAgICAgICAgICAtIEZvciBtYWtldXAgcHJvZHVjdHMsIGFuYWx5emUgaG93IHRoZXkgaW50ZXJhY3Qgd2l0aCBza2luY2FyZSB1bmRlcm5lYXRoIFxcXG4gICAgICAgICAgICAtIENvbnNpZGVyIHBpbGxpbmcsIG94aWRpemF0aW9uLCBhbmQgd2Vhci10aW1lIGludGVyYWN0aW9ucyBcXFxuICAgICAgICAgICAgLSBFWEFNUExFOiBGb3IgMyBwcm9kdWN0cyBbQSwgQiwgQ10sIHlvdSBtdXN0IGluY2x1ZGUgcGFpcnM6IEErQiwgQStDLCBCK0MgXFxcbiAgICAgICAgICAgIC0gRVhBTVBMRTogRm9yIDQgcHJvZHVjdHMgW0EsIEIsIEMsIERdLCB5b3UgbXVzdCBpbmNsdWRlIHBhaXJzOiBBK0IsIEErQywgQStELCBCK0MsIEIrRCwgQytEIFxcXG4gICAgICAgICAgICAtIElNUE9SVEFOVDogVXNlIHRoZSBtYXRjaGVkX3Byb2R1Y3QgbmFtZXMgY29uc2lzdGVudGx5IGluIGFsbCBwYWlycyB0byBhdm9pZCBkdXBsaWNhdGVzIFxcXG4gICAgICAgICAgICBQUk9EVUNUIE5BTUUgQ09SUkVDVElPTjogXFxcbiAgICAgICAgICAgIC0gSWYgdXNlciBpbnB1dCBoYXMgdHlwb3Mgb3IgaW5jb21wbGV0ZSBuYW1lcywgcmVzZWFyY2ggYW5kIHByb3ZpZGUgdGhlIGNvcnJlY3QgZnVsbCBwcm9kdWN0IG5hbWUgXFxcbiAgICAgICAgICAgIC0gVXNlIHByb3BlciBicmFuZCBjYXBpdGFsaXphdGlvbiAoZS5nLiwgJ1RoZSBPcmRpbmFyeScgbm90ICd0aGUgb3JkaW5hcnknKSBcXFxuICAgICAgICAgICAgLSBJbmNsdWRlIGZ1bGwgcHJvZHVjdCBuYW1lcyAoZS5nLiwgJ0NlcmFWZSBIeWRyYXRpbmcgRmFjaWFsIENsZWFuc2VyJyBub3QganVzdCAnY2VyYXZlIGNsZWFuc2VyJykgXFxcbiAgICAgICAgICAgIC0gVmVyaWZ5IHByb2R1Y3QgbmFtZXMgdGhyb3VnaCB3ZWIgc2VhcmNoIHdoZW4gdW5jZXJ0YWluIFxcXG4gICAgICAgICAgICBmcmVxdWVuY2llcyBleGFtcGxlczogXFxcbiAgICAgICAgICAgIHsgXFxcInJldGluYWxcXFwiOiBcXFwic3RhcnQgMuKAkzMgbmlnaHRzL3dlZWsgZm9yIDLigJMzIHdlZWtzLCB0aGVuIDPigJM0IG5pZ2h0cy93ZWVrIGlmIHRvbGVyYXRlZFxcXCIsIFxcXG4gICAgICAgICAgICAgIFxcXCJzYWxpY3lsaWMgYWNpZFxcXCI6IFxcXCIx4oCTM3gvd2Vla1xcXCIsIFxcXG4gICAgICAgICAgICAgIFxcXCJzdW5zY3JlZW5cXFwiOiBcXFwiZXZlcnkgQU1cXFwiLCBcXFxuICAgICAgICAgICAgICBcXFwiZm91bmRhdGlvblxcXCI6IFxcXCJkYWlseSBhcyBuZWVkZWRcXFwiLCBcXFxuICAgICAgICAgICAgICBcXFwicmV0aW5vbCBjcmVhbVxcXCI6IFxcXCIy4oCTMyBuaWdodHMvd2Vla1xcXCIgfSBcXFxuICAgICAgICAgICAgTVVMVEktRkFDVE9SIFJBVElORyAoMC01IHNjYWxlIHBlciBjYXRlZ29yeSk6IFxcXG4gICAgICAgICAgICAtIEJhcnJpZXIgU2FmZXR5OiA1PWV4Y2VsbGVudCBiYXJyaWVyIHN1cHBvcnQsIDA9YmFycmllciBkYW1hZ2luZyBcXFxuICAgICAgICAgICAgLSBJcnJpdGF0aW9uIFJpc2s6IDU9aGlnaCByaXNrLCAwPXZlcnkgZ2VudGxlIFxcXG4gICAgICAgICAgICAtIEVmZmljYWN5OiA1PWhpZ2hseSBlZmZlY3RpdmUgZm9yIGdvYWxzLCAwPW1pbmltYWwgYmVuZWZpdCBcXFxuICAgICAgICAgICAgLSBDb21wYXRpYmlsaXR5OiA1PXBlcmZlY3QgbGF5ZXJpbmcsIDA9Y29uZmxpY3RpbmcgaW5ncmVkaWVudHMgXFxcbiAgICAgICAgICAgIC0gTG9uZy10ZXJtIFNhZmV0eTogNT1zdXN0YWluYWJsZSBmb3IgeWVhcnMsIDA9dW5zYWZlIGxvbmctdGVybSBcXFxuICAgICAgICAgICAgTUFLRVVQLVNQRUNJRklDIEFOQUxZU0lTOiBcXFxuICAgICAgICAgICAgLSBBbmFseXplIGhvdyBtYWtldXAgaW5ncmVkaWVudHMgYWZmZWN0IHNraW4gaGVhbHRoIG92ZXIgdGltZSBcXFxuICAgICAgICAgICAgLSBDb25zaWRlciBjb21lZG9nZW5pYyBwb3RlbnRpYWwgb2YgbWFrZXVwIGluZ3JlZGllbnRzIFxcXG4gICAgICAgICAgICAtIEV2YWx1YXRlIGhvdyBtYWtldXAgaW50ZXJhY3RzIHdpdGggc2tpbmNhcmUgYWN0aXZlcyBcXFxuICAgICAgICAgICAgLSBMb29rIGZvciBwb3RlbnRpYWwgcGlsbGluZyBiZXR3ZWVuIHNraW5jYXJlIGFuZCBtYWtldXAgbGF5ZXJzIFxcXG4gICAgICAgICAgICAtIENoZWNrIGZvciBpbmdyZWRpZW50cyB0aGF0IG1heSBveGlkaXplIG9yIGJyZWFrIGRvd24gdG9nZXRoZXIgXFxcbiAgICAgICAgICAgIC0gQXNzZXNzIHdoZXRoZXIgbWFrZXVwIHByb3ZpZGVzIGFkZGl0aW9uYWwgc2tpbmNhcmUgYmVuZWZpdHMgKFNQRiwgYW50aW94aWRhbnRzLCBldGMuKSBcXFxuICAgICAgICAgICAgLSBDb25zaWRlciByZW1vdmFsIHJlcXVpcmVtZW50cyBhbmQgdGhlaXIgaW1wYWN0IG9uIHNraW4gYmFycmllclwiXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICByb2xlOiBcInVzZXJcIixcbiAgICAgICAgICBjb250ZW50OiBcIkV2YWx1YXRlIHRoaXMgcm91dGluZSBmb3IgY29tcGF0aWJpbGl0eSB1c2luZyB0aGUgZXhhY3Qgc2NoZW1hIGFib3ZlLlwiXG4gICAgICAgIH0sXG4gICAgICAgIHsgXG4gICAgICAgICAgcm9sZTogXCJ1c2VyXCIsIFxuICAgICAgICAgIGNvbnRlbnQ6IEpTT04uc3RyaW5naWZ5KHsgcHJvZHVjdHMgfSkgXG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9O1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MS9jaGF0L2NvbXBsZXRpb25zJywge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2FwaUtleX1gLFxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGFuYWx5emVCb2R5KSxcbiAgICB9KTtcblxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgT3BlbkFJIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgfVxuXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICBcbiAgICAvLyBFeHRyYWN0IHRoZSBKU09OIGNvbnRlbnQgZnJvbSB0aGUgT3BlbkFJIHJlc3BvbnNlXG4gICAgaWYgKGRhdGEuY2hvaWNlcyAmJiBkYXRhLmNob2ljZXNbMF0gJiYgZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UgJiYgZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmF3ID0gSlNPTi5wYXJzZShkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50KTtcbiAgICAgICAgbGV0IG91dDogQ29tcGF0O1xuICAgICAgICB0cnkge1xuICAgICAgICAgIG91dCA9IG5vcm1hbGl6ZShyYXcsIHByb2R1Y3RzKTtcbiAgICAgICAgfSBjYXRjaCAoZTogYW55KSB7XG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgICAgeyBlcnJvcjogeyBtZXNzYWdlOiBcIkludmFsaWQgbW9kZWwgSlNPTlwiLCBkZXRhaWxzOiBTdHJpbmcoZT8ubWVzc2FnZSB8fCBlKSB9IH0sXG4gICAgICAgICAgICB7IHN0YXR1czogNDIyIH1cbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihvdXQpO1xuICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwYXJzaW5nIE9wZW5BSSByZXNwb25zZTonLCBwYXJzZUVycm9yKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgIHsgZXJyb3I6ICdGYWlsZWQgdG8gcGFyc2UgYW5hbHlzaXMgcmVzdWx0JyB9LFxuICAgICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdJbnZhbGlkIHJlc3BvbnNlIGZyb20gT3BlbkFJJyB9LFxuICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gY29tcGF0aWJpbGl0eSBhbmFseXNpczonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byBhbmFseXplIGNvbXBhdGliaWxpdHknIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIm5vcm1hbGl6ZSIsIm91dCIsIm9yaWdpbmFsUHJvZHVjdHMiLCJFcnJvciIsInJlcyIsInJvdXRpbmVfcmF0aW5nIiwiYmFycmllcl9zYWZldHkiLCJNYXRoIiwibWF4IiwibWluIiwicm91bmQiLCJpcnJpdGF0aW9uX3Jpc2siLCJlZmZpY2FjeSIsImNvbXBhdGliaWxpdHkiLCJsb25nX3Rlcm1fc2FmZXR5IiwidW5kZWZpbmVkIiwic2NvcmVfcmF0aW9uYWxlIiwicm91dGluZV9wbGFuIiwiYW0iLCJBcnJheSIsImlzQXJyYXkiLCJwbSIsImZyZXF1ZW5jaWVzIiwicHJvZHVjdHMiLCJtYXAiLCJwIiwicXVlcnkiLCJtYXRjaGVkX3Byb2R1Y3QiLCJuYW1lIiwicm9sZSIsImtleV9iZW5lZml0cyIsImNhdXRpb25zIiwiaW5ncmVkaWVudHNfaW5jaSIsImNpdGF0aW9ucyIsInNraW5faW1wYWN0IiwiYW5hbHlzaXMiLCJwYWlycyIsImdsb2JhbF9vYnNlcnZhdGlvbnMiLCJzdWdnZXN0aW9ucyIsIm1ha2V1cF9za2luY2FyZV9zeW5lcmd5IiwiZnJlcSIsImxvd2VyS2V5cyIsIk9iamVjdCIsImtleXMiLCJyZWR1Y2UiLCJhY2MiLCJrIiwidG9Mb3dlckNhc2UiLCJtZW50aW9uc1JldGlub2lkIiwicyIsInRlc3QiLCJuZWVkc1JhbXAiLCJzb21lIiwia2V5IiwiZmluZCIsIm9yaWdpbmFsS2V5IiwiZXhwZWN0ZWRQYWlycyIsImxlbmd0aCIsImV4aXN0aW5nUGFpcnMiLCJleGlzdGluZ1BhaXJTZXQiLCJTZXQiLCJmb3JFYWNoIiwicGFpciIsIm5vcm1hbGl6ZWRQYWlyIiwiYmV0d2VlbiIsInRyaW0iLCJzb3J0Iiwiam9pbiIsImFkZCIsImkiLCJqIiwicHJvZHVjdDEiLCJwcm9kdWN0MiIsImhhcyIsImlzTWFrZXVwU2tpbmNhcmUiLCJpbmNsdWRlcyIsInB1c2giLCJmbGFncyIsInR5cGUiLCJzZXZlcml0eSIsIndoeSIsInNvdXJjZXMiLCJtaXNzaW5nQ2l0ZXMiLCJQT1NUIiwicmVxdWVzdCIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJPUEVOQUlfQVBJX0tFWSIsImFuYWx5emVCb2R5IiwibW9kZWwiLCJ0ZW1wZXJhdHVyZSIsInJlc3BvbnNlX2Zvcm1hdCIsInRvb2xzIiwibWVzc2FnZXMiLCJjb250ZW50IiwiSlNPTiIsInN0cmluZ2lmeSIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIm9rIiwiZGF0YSIsImNob2ljZXMiLCJtZXNzYWdlIiwicmF3IiwicGFyc2UiLCJlIiwiZGV0YWlscyIsIlN0cmluZyIsInBhcnNlRXJyb3IiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/compatibility/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcompatibility%2Froute&page=%2Fapi%2Fcompatibility%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcompatibility%2Froute.ts&appDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();