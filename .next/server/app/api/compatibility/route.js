"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/compatibility/route";
exports.ids = ["app/api/compatibility/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcompatibility%2Froute&page=%2Fapi%2Fcompatibility%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcompatibility%2Froute.ts&appDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcompatibility%2Froute&page=%2Fapi%2Fcompatibility%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcompatibility%2Froute.ts&appDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_shaivirau_Skincare_skin_check_app_api_compatibility_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/compatibility/route.ts */ \"(rsc)/./app/api/compatibility/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/compatibility/route\",\n        pathname: \"/api/compatibility\",\n        filename: \"route\",\n        bundlePath: \"app/api/compatibility/route\"\n    },\n    resolvedPagePath: \"/Users/shaivirau/Skincare/skin-check/app/api/compatibility/route.ts\",\n    nextConfigOutput,\n    userland: _Users_shaivirau_Skincare_skin_check_app_api_compatibility_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/compatibility/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjb21wYXRpYmlsaXR5JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjb21wYXRpYmlsaXR5JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY29tcGF0aWJpbGl0eSUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnNoYWl2aXJhdSUyRlNraW5jYXJlJTJGc2tpbi1jaGVjayUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZzaGFpdmlyYXUlMkZTa2luY2FyZSUyRnNraW4tY2hlY2smaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDbUI7QUFDaEc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9za2luLWNoZWNrLz85NWRkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9zaGFpdmlyYXUvU2tpbmNhcmUvc2tpbi1jaGVjay9hcHAvYXBpL2NvbXBhdGliaWxpdHkvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NvbXBhdGliaWxpdHkvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jb21wYXRpYmlsaXR5XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9jb21wYXRpYmlsaXR5L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL3NoYWl2aXJhdS9Ta2luY2FyZS9za2luLWNoZWNrL2FwcC9hcGkvY29tcGF0aWJpbGl0eS9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9jb21wYXRpYmlsaXR5L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcompatibility%2Froute&page=%2Fapi%2Fcompatibility%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcompatibility%2Froute.ts&appDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/compatibility/route.ts":
/*!****************************************!*\
  !*** ./app/api/compatibility/route.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n\nfunction normalize(out, originalProducts) {\n    // Basic shape validation\n    if (typeof out !== \"object\" || out === null) throw new Error(\"Bad JSON\");\n    // Ensure all required fields exist with defaults\n    const res = {\n        routine_rating: out.routine_rating ? {\n            barrier_safety: Math.max(0, Math.min(5, Math.round(out.routine_rating.barrier_safety || 3))),\n            irritation_risk: Math.max(0, Math.min(5, Math.round(out.routine_rating.irritation_risk || 2))),\n            efficacy: Math.max(0, Math.min(5, Math.round(out.routine_rating.efficacy || 3))),\n            compatibility: Math.max(0, Math.min(5, Math.round(out.routine_rating.compatibility || 3))),\n            long_term_safety: out.routine_rating.long_term_safety ? Math.max(0, Math.min(5, Math.round(out.routine_rating.long_term_safety))) : undefined\n        } : {\n            barrier_safety: 3,\n            irritation_risk: 2,\n            efficacy: 3,\n            compatibility: 3,\n            long_term_safety: 3\n        },\n        score_rationale: out.score_rationale || \"Analysis completed successfully.\",\n        routine_plan: {\n            am: Array.isArray(out.routine_plan?.am) ? out.routine_plan.am : [],\n            pm: Array.isArray(out.routine_plan?.pm) ? out.routine_plan.pm : [],\n            frequencies: out.routine_plan?.frequencies || {}\n        },\n        products: Array.isArray(out.products) ? out.products.map((p)=>({\n                query: p.query || \"\",\n                matched_product: p.matched_product || p.name || \"\",\n                role: p.role || \"Skincare product\",\n                key_benefits: Array.isArray(p.key_benefits) ? p.key_benefits : [\n                    \"General skincare benefits\"\n                ],\n                cautions: Array.isArray(p.cautions) ? p.cautions : [],\n                ingredients_inci: p.ingredients_inci || \"unknown\",\n                citations: Array.isArray(p.citations) ? p.citations : [],\n                skin_impact: p.skin_impact || \"General product effects on skin\"\n            })) : originalProducts.map((p)=>({\n                query: p,\n                matched_product: p,\n                role: \"Skincare product\",\n                key_benefits: [\n                    \"General skincare benefits\"\n                ],\n                cautions: [],\n                ingredients_inci: \"unknown\",\n                citations: [],\n                skin_impact: \"General product effects on skin\"\n            })),\n        analysis: {\n            pairs: Array.isArray(out.analysis?.pairs) ? out.analysis.pairs : [],\n            global_observations: Array.isArray(out.analysis?.global_observations) ? out.analysis.global_observations : [\n                \"Routine analysis completed.\"\n            ],\n            suggestions: Array.isArray(out.analysis?.suggestions) ? out.analysis.suggestions : [],\n            makeup_skincare_synergy: Array.isArray(out.analysis?.makeup_skincare_synergy) ? out.analysis.makeup_skincare_synergy : []\n        }\n    };\n    // Frequencies guardrail for retinoids\n    const freq = res.routine_plan?.frequencies || {};\n    const lowerKeys = Object.keys(freq).reduce((acc, k)=>{\n        acc[k.toLowerCase()] = k;\n        return acc;\n    }, {});\n    const mentionsRetinoid = (s)=>/retin(al|ol)|retinoid/i.test(s);\n    const needsRamp = Object.keys(lowerKeys).some((k)=>mentionsRetinoid(k)) || (res.products || []).some((p)=>mentionsRetinoid(p.role) || mentionsRetinoid(p.matched_product));\n    if (needsRamp) {\n        const key = Object.keys(lowerKeys).find((k)=>mentionsRetinoid(k)) ?? \"retinal\";\n        const originalKey = lowerKeys[key] ?? key;\n        freq[originalKey] = \"start 2–3 nights/week for 2–3 weeks, then 3–4 nights/week if tolerated\";\n    }\n    // Ensure ALL compatibility pairs exist - generate missing ones\n    const expectedPairs = (res.products?.length || 0) * ((res.products?.length || 0) - 1) / 2;\n    const existingPairs = res.analysis?.pairs?.length || 0;\n    if (expectedPairs > 0) {\n        // Create a set of existing pairs for quick lookup (normalize to lowercase)\n        const existingPairSet = new Set();\n        (res.analysis?.pairs || []).forEach((pair)=>{\n            const normalizedPair = pair.between.map((p)=>p.toLowerCase().trim()).sort().join(\"|\");\n            existingPairSet.add(normalizedPair);\n        });\n        // Generate missing pairs\n        for(let i = 0; i < (res.products?.length || 0); i++){\n            for(let j = i + 1; j < (res.products?.length || 0); j++){\n                const product1 = res.products?.[i]?.matched_product || res.products?.[i]?.query || \"\";\n                const product2 = res.products?.[j]?.matched_product || res.products?.[j]?.query || \"\";\n                const normalizedPair = [\n                    product1.toLowerCase().trim(),\n                    product2.toLowerCase().trim()\n                ].sort().join(\"|\");\n                if (!existingPairSet.has(normalizedPair)) {\n                    // Determine if this is a makeup-skincare interaction\n                    const isMakeupSkincare = (product1.toLowerCase().includes(\"concealer\") || product1.toLowerCase().includes(\"blush\") || product1.toLowerCase().includes(\"mascara\") || product1.toLowerCase().includes(\"foundation\") || product1.toLowerCase().includes(\"lip\")) && (product2.toLowerCase().includes(\"sunscreen\") || product2.toLowerCase().includes(\"toner\") || product2.toLowerCase().includes(\"cleanser\") || product2.toLowerCase().includes(\"cream\") || product2.toLowerCase().includes(\"serum\")) || (product2.toLowerCase().includes(\"concealer\") || product2.toLowerCase().includes(\"blush\") || product2.toLowerCase().includes(\"mascara\") || product2.toLowerCase().includes(\"foundation\") || product2.toLowerCase().includes(\"lip\")) && (product1.toLowerCase().includes(\"sunscreen\") || product1.toLowerCase().includes(\"toner\") || product1.toLowerCase().includes(\"cleanser\") || product1.toLowerCase().includes(\"cream\") || product1.toLowerCase().includes(\"serum\"));\n                    res.analysis?.pairs?.push({\n                        between: [\n                            product1,\n                            product2\n                        ],\n                        flags: [\n                            {\n                                type: isMakeupSkincare ? \"makeup_skincare_interaction\" : \"ok_together\",\n                                severity: \"low\",\n                                why: isMakeupSkincare ? \"Makeup and skincare products can work well together when applied in the correct order.\" : \"Products appear compatible based on general formulation principles.\",\n                                sources: [\n                                    \"General skincare compatibility guidelines\"\n                                ]\n                            }\n                        ],\n                        suggestions: isMakeupSkincare ? [\n                            \"Apply skincare first, allow to absorb, then apply makeup.\"\n                        ] : [\n                            \"Monitor for any irritation when using together.\"\n                        ]\n                    });\n                }\n            }\n        }\n    }\n    // Citation reminder if benefits/cautions exist but citations missing\n    const missingCites = (res.products || []).some((p)=>(p.key_benefits.length > 0 || p.cautions.length > 0) && p.citations.length === 0);\n    if (missingCites) {\n        res.analysis?.suggestions?.push(\"Some product claims lack citations; prefer brand pages or INCIDecoder when listing INCI or ingredient-based benefits.\");\n    }\n    return res;\n}\nasync function POST(request) {\n    try {\n        const { products } = await request.json();\n        if (!products || !Array.isArray(products)) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Products array is required\"\n            }, {\n                status: 400\n            });\n        }\n        const apiKey = process.env.OPENAI_API_KEY;\n        if (!apiKey) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"OpenAI API key not configured\"\n            }, {\n                status: 500\n            });\n        }\n        const analyzeBody = {\n            model: \"gpt-4o-mini\",\n            temperature: 0.3,\n            response_format: {\n                type: \"json_object\"\n            },\n            messages: [\n                {\n                    role: \"system\",\n                    content: 'You are a cosmetic chemist + skincare educator with expertise in both skincare and makeup formulations. CRITICAL: You MUST output a complete, consistent JSON response every time.             MANDATORY REQUIREMENTS:             1) ALWAYS include ALL fields in this EXACT schema:             {               \"routine_rating\": {                 \"barrier_safety\": number (0-5 scale),                 \"irritation_risk\": number (0-5 scale, lower is better),                 \"efficacy\": number (0-5 scale),                 \"compatibility\": number (0-5 scale),                 \"long_term_safety\": number (0-5 scale, optional)               },               \"score_rationale\": string (2-4 sentences),               \"routine_plan\": {                 \"am\": string[] (MUST have at least 1 item),                 \"pm\": string[] (MUST have at least 1 item),                 \"frequencies\": { [productOrActive: string]: string } (MUST have at least 1 frequency)               },               \"products\": [                 {                   \"query\": string,                   \"matched_product\": string,                   \"role\": string (specify if skincare or makeup),                   \"key_benefits\": string[] (MUST have at least 1 benefit),                   \"cautions\": string[] (can be empty array),                   \"ingredients_inci\": { \"names\": string[] } | \"unknown\",                   \"citations\": string[] (MUST have at least 1 citation),                   \"skin_impact\": string (how this product affects skin health)                 }               ],               \"analysis\": {                 \"pairs\": [                   {                     \"between\": [string, string],                     \"flags\": [                       {                         \"type\": \"ok_together\" | \"irritation_stack\" | \"redundancy\" | \"caution\" | \"makeup_skincare_interaction\" | \"pilling_risk\" | \"oxidization_risk\",                         \"severity\": \"low\" | \"medium\" | \"high\",                         \"why\": string,                         \"sources\": string[]                       }                     ],                     \"suggestions\": string[]                   }                 ],                 \"global_observations\": string[] (MUST have at least 2 observations),                 \"suggestions\": string[] (MUST have at least 1 suggestion),                 \"makeup_skincare_synergy\": string[] (how makeup and skincare work together)               }             }             CONSISTENCY RULES:             - CRITICAL: You MUST analyze compatibility between EVERY SINGLE product pair. If there are N products, you must include exactly N*(N-1)/2 pairs in the analysis.pairs array             - ALWAYS use the EXACT \"matched_product\" names from the products array when creating pairs - do NOT use the original query names             - ALWAYS include routine_plan.am and pm arrays (never empty)             - ALWAYS include global_observations (minimum 2 items)             - ALWAYS include suggestions (minimum 1 item)             - If unsure about ingredients, use \"unknown\" but still provide analysis             - For makeup products, analyze how they interact with skincare underneath             - Consider pilling, oxidization, and wear-time interactions             - EXAMPLE: For 3 products [A, B, C], you must include pairs: A+B, A+C, B+C             - EXAMPLE: For 4 products [A, B, C, D], you must include pairs: A+B, A+C, A+D, B+C, B+D, C+D             - IMPORTANT: Use the matched_product names consistently in all pairs to avoid duplicates             frequencies examples:             { \"retinal\": \"start 2–3 nights/week for 2–3 weeks, then 3–4 nights/week if tolerated\",               \"salicylic acid\": \"1–3x/week\",               \"sunscreen\": \"every AM\",               \"foundation\": \"daily as needed\",               \"retinol cream\": \"2–3 nights/week\" }             MULTI-FACTOR RATING (0-5 scale per category):             - Barrier Safety: 5=excellent barrier support, 0=barrier damaging             - Irritation Risk: 5=high risk, 0=very gentle             - Efficacy: 5=highly effective for goals, 0=minimal benefit             - Compatibility: 5=perfect layering, 0=conflicting ingredients             - Long-term Safety: 5=sustainable for years, 0=unsafe long-term             MAKEUP-SPECIFIC ANALYSIS:             - Analyze how makeup ingredients affect skin health over time             - Consider comedogenic potential of makeup ingredients             - Evaluate how makeup interacts with skincare actives             - Look for potential pilling between skincare and makeup layers             - Check for ingredients that may oxidize or break down together             - Assess whether makeup provides additional skincare benefits (SPF, antioxidants, etc.)             - Consider removal requirements and their impact on skin barrier'\n                },\n                {\n                    role: \"user\",\n                    content: \"Evaluate this routine for compatibility using the exact schema above.\"\n                },\n                {\n                    role: \"user\",\n                    content: JSON.stringify({\n                        products\n                    })\n                }\n            ]\n        };\n        const response = await fetch(\"https://api.openai.com/v1/chat/completions\", {\n            method: \"POST\",\n            headers: {\n                \"Authorization\": `Bearer ${apiKey}`,\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify(analyzeBody)\n        });\n        if (!response.ok) {\n            throw new Error(`OpenAI API error: ${response.status}`);\n        }\n        const data = await response.json();\n        // Extract the JSON content from the OpenAI response\n        if (data.choices && data.choices[0] && data.choices[0].message && data.choices[0].message.content) {\n            try {\n                const raw = JSON.parse(data.choices[0].message.content);\n                let out;\n                try {\n                    out = normalize(raw, products);\n                } catch (e) {\n                    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                        error: {\n                            message: \"Invalid model JSON\",\n                            details: String(e?.message || e)\n                        }\n                    }, {\n                        status: 422\n                    });\n                }\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(out);\n            } catch (parseError) {\n                console.error(\"Error parsing OpenAI response:\", parseError);\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: \"Failed to parse analysis result\"\n                }, {\n                    status: 500\n                });\n            }\n        } else {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Invalid response from OpenAI\"\n            }, {\n                status: 500\n            });\n        }\n    } catch (error) {\n        console.error(\"Error in compatibility analysis:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Failed to analyze compatibility\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2NvbXBhdGliaWxpdHkvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBd0Q7QUEyQnhELFNBQVNDLFVBQVVDLEdBQVEsRUFBRUMsZ0JBQTBCO0lBQ3JELHlCQUF5QjtJQUN6QixJQUFJLE9BQU9ELFFBQVEsWUFBWUEsUUFBUSxNQUFNLE1BQU0sSUFBSUUsTUFBTTtJQUU3RCxpREFBaUQ7SUFDakQsTUFBTUMsTUFBYztRQUNsQkMsZ0JBQWdCSixJQUFJSSxjQUFjLEdBQUc7WUFDbkNDLGdCQUFnQkMsS0FBS0MsR0FBRyxDQUFDLEdBQUdELEtBQUtFLEdBQUcsQ0FBQyxHQUFHRixLQUFLRyxLQUFLLENBQUNULElBQUlJLGNBQWMsQ0FBQ0MsY0FBYyxJQUFJO1lBQ3hGSyxpQkFBaUJKLEtBQUtDLEdBQUcsQ0FBQyxHQUFHRCxLQUFLRSxHQUFHLENBQUMsR0FBR0YsS0FBS0csS0FBSyxDQUFDVCxJQUFJSSxjQUFjLENBQUNNLGVBQWUsSUFBSTtZQUMxRkMsVUFBVUwsS0FBS0MsR0FBRyxDQUFDLEdBQUdELEtBQUtFLEdBQUcsQ0FBQyxHQUFHRixLQUFLRyxLQUFLLENBQUNULElBQUlJLGNBQWMsQ0FBQ08sUUFBUSxJQUFJO1lBQzVFQyxlQUFlTixLQUFLQyxHQUFHLENBQUMsR0FBR0QsS0FBS0UsR0FBRyxDQUFDLEdBQUdGLEtBQUtHLEtBQUssQ0FBQ1QsSUFBSUksY0FBYyxDQUFDUSxhQUFhLElBQUk7WUFDdEZDLGtCQUFrQmIsSUFBSUksY0FBYyxDQUFDUyxnQkFBZ0IsR0FBR1AsS0FBS0MsR0FBRyxDQUFDLEdBQUdELEtBQUtFLEdBQUcsQ0FBQyxHQUFHRixLQUFLRyxLQUFLLENBQUNULElBQUlJLGNBQWMsQ0FBQ1MsZ0JBQWdCLE1BQU1DO1FBQ3RJLElBQUk7WUFDRlQsZ0JBQWdCO1lBQ2hCSyxpQkFBaUI7WUFDakJDLFVBQVU7WUFDVkMsZUFBZTtZQUNmQyxrQkFBa0I7UUFDcEI7UUFDQUUsaUJBQWlCZixJQUFJZSxlQUFlLElBQUk7UUFDeENDLGNBQWM7WUFDWkMsSUFBSUMsTUFBTUMsT0FBTyxDQUFDbkIsSUFBSWdCLFlBQVksRUFBRUMsTUFBTWpCLElBQUlnQixZQUFZLENBQUNDLEVBQUUsR0FBRyxFQUFFO1lBQ2xFRyxJQUFJRixNQUFNQyxPQUFPLENBQUNuQixJQUFJZ0IsWUFBWSxFQUFFSSxNQUFNcEIsSUFBSWdCLFlBQVksQ0FBQ0ksRUFBRSxHQUFHLEVBQUU7WUFDbEVDLGFBQWFyQixJQUFJZ0IsWUFBWSxFQUFFSyxlQUFlLENBQUM7UUFDakQ7UUFDQUMsVUFBVUosTUFBTUMsT0FBTyxDQUFDbkIsSUFBSXNCLFFBQVEsSUFBSXRCLElBQUlzQixRQUFRLENBQUNDLEdBQUcsQ0FBQyxDQUFDQyxJQUFZO2dCQUNwRUMsT0FBT0QsRUFBRUMsS0FBSyxJQUFJO2dCQUNsQkMsaUJBQWlCRixFQUFFRSxlQUFlLElBQUlGLEVBQUVHLElBQUksSUFBSTtnQkFDaERDLE1BQU1KLEVBQUVJLElBQUksSUFBSTtnQkFDaEJDLGNBQWNYLE1BQU1DLE9BQU8sQ0FBQ0ssRUFBRUssWUFBWSxJQUFJTCxFQUFFSyxZQUFZLEdBQUc7b0JBQUM7aUJBQTRCO2dCQUM1RkMsVUFBVVosTUFBTUMsT0FBTyxDQUFDSyxFQUFFTSxRQUFRLElBQUlOLEVBQUVNLFFBQVEsR0FBRyxFQUFFO2dCQUNyREMsa0JBQWtCUCxFQUFFTyxnQkFBZ0IsSUFBSTtnQkFDeENDLFdBQVdkLE1BQU1DLE9BQU8sQ0FBQ0ssRUFBRVEsU0FBUyxJQUFJUixFQUFFUSxTQUFTLEdBQUcsRUFBRTtnQkFDeERDLGFBQWFULEVBQUVTLFdBQVcsSUFBSTtZQUNoQyxNQUFNaEMsaUJBQWlCc0IsR0FBRyxDQUFDQyxDQUFBQSxJQUFNO2dCQUMvQkMsT0FBT0Q7Z0JBQ1BFLGlCQUFpQkY7Z0JBQ2pCSSxNQUFNO2dCQUNOQyxjQUFjO29CQUFDO2lCQUE0QjtnQkFDM0NDLFVBQVUsRUFBRTtnQkFDWkMsa0JBQWtCO2dCQUNsQkMsV0FBVyxFQUFFO2dCQUNiQyxhQUFhO1lBQ2Y7UUFDQUMsVUFBVTtZQUNSQyxPQUFPakIsTUFBTUMsT0FBTyxDQUFDbkIsSUFBSWtDLFFBQVEsRUFBRUMsU0FBU25DLElBQUlrQyxRQUFRLENBQUNDLEtBQUssR0FBRyxFQUFFO1lBQ25FQyxxQkFBcUJsQixNQUFNQyxPQUFPLENBQUNuQixJQUFJa0MsUUFBUSxFQUFFRSx1QkFBdUJwQyxJQUFJa0MsUUFBUSxDQUFDRSxtQkFBbUIsR0FBRztnQkFBQzthQUE4QjtZQUMxSUMsYUFBYW5CLE1BQU1DLE9BQU8sQ0FBQ25CLElBQUlrQyxRQUFRLEVBQUVHLGVBQWVyQyxJQUFJa0MsUUFBUSxDQUFDRyxXQUFXLEdBQUcsRUFBRTtZQUNyRkMseUJBQXlCcEIsTUFBTUMsT0FBTyxDQUFDbkIsSUFBSWtDLFFBQVEsRUFBRUksMkJBQTJCdEMsSUFBSWtDLFFBQVEsQ0FBQ0ksdUJBQXVCLEdBQUcsRUFBRTtRQUMzSDtJQUNGO0lBRUEsc0NBQXNDO0lBQ3RDLE1BQU1DLE9BQU9wQyxJQUFJYSxZQUFZLEVBQUVLLGVBQWUsQ0FBQztJQUMvQyxNQUFNbUIsWUFBWUMsT0FBT0MsSUFBSSxDQUFDSCxNQUFNSSxNQUFNLENBQUMsQ0FBQ0MsS0FBSUM7UUFBTUQsR0FBRyxDQUFDQyxFQUFFQyxXQUFXLEdBQUcsR0FBR0Q7UUFBRyxPQUFPRDtJQUFLLEdBQUcsQ0FBQztJQUNoRyxNQUFNRyxtQkFBbUIsQ0FBQ0MsSUFBVyx5QkFBeUJDLElBQUksQ0FBQ0Q7SUFDbkUsTUFBTUUsWUFBWVQsT0FBT0MsSUFBSSxDQUFDRixXQUFXVyxJQUFJLENBQUNOLENBQUFBLElBQUdFLGlCQUFpQkYsT0FDaEUsQ0FBQzFDLElBQUltQixRQUFRLElBQUksRUFBRSxFQUFFNkIsSUFBSSxDQUFDM0IsQ0FBQUEsSUFBR3VCLGlCQUFpQnZCLEVBQUVJLElBQUksS0FBR21CLGlCQUFpQnZCLEVBQUVFLGVBQWU7SUFFM0YsSUFBSXdCLFdBQVc7UUFDYixNQUFNRSxNQUFNWCxPQUFPQyxJQUFJLENBQUNGLFdBQVdhLElBQUksQ0FBQ1IsQ0FBQUEsSUFBR0UsaUJBQWlCRixPQUFPO1FBQ25FLE1BQU1TLGNBQWNkLFNBQVMsQ0FBQ1ksSUFBSSxJQUFJQTtRQUN0Q2IsSUFBSSxDQUFDZSxZQUFZLEdBQUc7SUFDdEI7SUFFQSwrREFBK0Q7SUFDL0QsTUFBTUMsZ0JBQWdCLENBQUNwRCxJQUFJbUIsUUFBUSxFQUFFa0MsVUFBVSxLQUFNLEVBQUNyRCxJQUFJbUIsUUFBUSxFQUFFa0MsVUFBVSxLQUFLLEtBQUs7SUFDeEYsTUFBTUMsZ0JBQWdCdEQsSUFBSStCLFFBQVEsRUFBRUMsT0FBT3FCLFVBQVU7SUFFckQsSUFBSUQsZ0JBQWdCLEdBQUc7UUFDckIsMkVBQTJFO1FBQzNFLE1BQU1HLGtCQUFrQixJQUFJQztRQUMzQnhELENBQUFBLElBQUkrQixRQUFRLEVBQUVDLFNBQVMsRUFBRSxFQUFFeUIsT0FBTyxDQUFDQyxDQUFBQTtZQUNsQyxNQUFNQyxpQkFBaUJELEtBQUtFLE9BQU8sQ0FBQ3hDLEdBQUcsQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRXNCLFdBQVcsR0FBR2tCLElBQUksSUFBSUMsSUFBSSxHQUFHQyxJQUFJLENBQUM7WUFDakZSLGdCQUFnQlMsR0FBRyxDQUFDTDtRQUN0QjtRQUVBLHlCQUF5QjtRQUN6QixJQUFLLElBQUlNLElBQUksR0FBR0EsSUFBS2pFLENBQUFBLElBQUltQixRQUFRLEVBQUVrQyxVQUFVLElBQUlZLElBQUs7WUFDcEQsSUFBSyxJQUFJQyxJQUFJRCxJQUFJLEdBQUdDLElBQUtsRSxDQUFBQSxJQUFJbUIsUUFBUSxFQUFFa0MsVUFBVSxJQUFJYSxJQUFLO2dCQUN4RCxNQUFNQyxXQUFXbkUsSUFBSW1CLFFBQVEsRUFBRSxDQUFDOEMsRUFBRSxFQUFFMUMsbUJBQW1CdkIsSUFBSW1CLFFBQVEsRUFBRSxDQUFDOEMsRUFBRSxFQUFFM0MsU0FBUztnQkFDbkYsTUFBTThDLFdBQVdwRSxJQUFJbUIsUUFBUSxFQUFFLENBQUMrQyxFQUFFLEVBQUUzQyxtQkFBbUJ2QixJQUFJbUIsUUFBUSxFQUFFLENBQUMrQyxFQUFFLEVBQUU1QyxTQUFTO2dCQUNuRixNQUFNcUMsaUJBQWlCO29CQUFDUSxTQUFTeEIsV0FBVyxHQUFHa0IsSUFBSTtvQkFBSU8sU0FBU3pCLFdBQVcsR0FBR2tCLElBQUk7aUJBQUcsQ0FBQ0MsSUFBSSxHQUFHQyxJQUFJLENBQUM7Z0JBRWxHLElBQUksQ0FBQ1IsZ0JBQWdCYyxHQUFHLENBQUNWLGlCQUFpQjtvQkFDeEMscURBQXFEO29CQUNyRCxNQUFNVyxtQkFBbUIsQ0FDdEJILFNBQVN4QixXQUFXLEdBQUc0QixRQUFRLENBQUMsZ0JBQ2hDSixTQUFTeEIsV0FBVyxHQUFHNEIsUUFBUSxDQUFDLFlBQ2hDSixTQUFTeEIsV0FBVyxHQUFHNEIsUUFBUSxDQUFDLGNBQ2hDSixTQUFTeEIsV0FBVyxHQUFHNEIsUUFBUSxDQUFDLGlCQUNoQ0osU0FBU3hCLFdBQVcsR0FBRzRCLFFBQVEsQ0FBQyxNQUFLLEtBQ3JDSCxDQUFBQSxTQUFTekIsV0FBVyxHQUFHNEIsUUFBUSxDQUFDLGdCQUNoQ0gsU0FBU3pCLFdBQVcsR0FBRzRCLFFBQVEsQ0FBQyxZQUNoQ0gsU0FBU3pCLFdBQVcsR0FBRzRCLFFBQVEsQ0FBQyxlQUNoQ0gsU0FBU3pCLFdBQVcsR0FBRzRCLFFBQVEsQ0FBQyxZQUNoQ0gsU0FBU3pCLFdBQVcsR0FBRzRCLFFBQVEsQ0FBQyxRQUFPLEtBRXhDLENBQUNILFNBQVN6QixXQUFXLEdBQUc0QixRQUFRLENBQUMsZ0JBQ2hDSCxTQUFTekIsV0FBVyxHQUFHNEIsUUFBUSxDQUFDLFlBQ2hDSCxTQUFTekIsV0FBVyxHQUFHNEIsUUFBUSxDQUFDLGNBQ2hDSCxTQUFTekIsV0FBVyxHQUFHNEIsUUFBUSxDQUFDLGlCQUNoQ0gsU0FBU3pCLFdBQVcsR0FBRzRCLFFBQVEsQ0FBQyxNQUFLLEtBQ3JDSixDQUFBQSxTQUFTeEIsV0FBVyxHQUFHNEIsUUFBUSxDQUFDLGdCQUNoQ0osU0FBU3hCLFdBQVcsR0FBRzRCLFFBQVEsQ0FBQyxZQUNoQ0osU0FBU3hCLFdBQVcsR0FBRzRCLFFBQVEsQ0FBQyxlQUNoQ0osU0FBU3hCLFdBQVcsR0FBRzRCLFFBQVEsQ0FBQyxZQUNoQ0osU0FBU3hCLFdBQVcsR0FBRzRCLFFBQVEsQ0FBQyxRQUFPO29CQUcxQ3ZFLElBQUkrQixRQUFRLEVBQUVDLE9BQU93QyxLQUFLO3dCQUN4QlosU0FBUzs0QkFBQ087NEJBQVVDO3lCQUFTO3dCQUM3QkssT0FBTzs0QkFBQztnQ0FDTkMsTUFBTUosbUJBQW1CLGdDQUFnQztnQ0FDekRLLFVBQVU7Z0NBQ1ZDLEtBQUtOLG1CQUNELDJGQUNBO2dDQUNKTyxTQUFTO29DQUFDO2lDQUE0Qzs0QkFDeEQ7eUJBQUU7d0JBQ0YzQyxhQUFhb0MsbUJBQ1Q7NEJBQUM7eUJBQTRELEdBQzdEOzRCQUFDO3lCQUFrRDtvQkFDekQ7Z0JBQ0Y7WUFDRjtRQUNGO0lBQ0Y7SUFFQSxxRUFBcUU7SUFDckUsTUFBTVEsZUFBZSxDQUFDOUUsSUFBSW1CLFFBQVEsSUFBSSxFQUFFLEVBQUU2QixJQUFJLENBQUMzQixDQUFBQSxJQUFLLENBQUNBLEVBQUVLLFlBQVksQ0FBQzJCLE1BQU0sR0FBRyxLQUFLaEMsRUFBRU0sUUFBUSxDQUFDMEIsTUFBTSxHQUFHLE1BQU1oQyxFQUFFUSxTQUFTLENBQUN3QixNQUFNLEtBQUs7SUFDbkksSUFBSXlCLGNBQWM7UUFDaEI5RSxJQUFJK0IsUUFBUSxFQUFFRyxhQUFhc0MsS0FBSztJQUNsQztJQUVBLE9BQU94RTtBQUNUO0FBRU8sZUFBZStFLEtBQUtDLE9BQW9CO0lBQzdDLElBQUk7UUFDRixNQUFNLEVBQUU3RCxRQUFRLEVBQUUsR0FBRyxNQUFNNkQsUUFBUUMsSUFBSTtRQUV2QyxJQUFJLENBQUM5RCxZQUFZLENBQUNKLE1BQU1DLE9BQU8sQ0FBQ0csV0FBVztZQUN6QyxPQUFPeEIsa0ZBQVlBLENBQUNzRixJQUFJLENBQ3RCO2dCQUFFQyxPQUFPO1lBQTZCLEdBQ3RDO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxNQUFNQyxTQUFTQyxRQUFRQyxHQUFHLENBQUNDLGNBQWM7UUFDekMsSUFBSSxDQUFDSCxRQUFRO1lBQ1gsT0FBT3pGLGtGQUFZQSxDQUFDc0YsSUFBSSxDQUN0QjtnQkFBRUMsT0FBTztZQUFnQyxHQUN6QztnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsTUFBTUssY0FBYztZQUNsQkMsT0FBTztZQUNQQyxhQUFhO1lBQ2JDLGlCQUFpQjtnQkFBRWpCLE1BQU07WUFBYztZQUN2Q2tCLFVBQVU7Z0JBQ1I7b0JBQ0VuRSxNQUFNO29CQUNOb0UsU0FDRTtnQkFpRko7Z0JBQ0E7b0JBQ0VwRSxNQUFNO29CQUNOb0UsU0FBUztnQkFDWDtnQkFDQTtvQkFDRXBFLE1BQU07b0JBQ05vRSxTQUFTQyxLQUFLQyxTQUFTLENBQUM7d0JBQUU1RTtvQkFBUztnQkFDckM7YUFDRDtRQUNIO1FBRUEsTUFBTTZFLFdBQVcsTUFBTUMsTUFBTSw4Q0FBOEM7WUFDekVDLFFBQVE7WUFDUkMsU0FBUztnQkFDUCxpQkFBaUIsQ0FBQyxPQUFPLEVBQUVmLE9BQU8sQ0FBQztnQkFDbkMsZ0JBQWdCO1lBQ2xCO1lBQ0FnQixNQUFNTixLQUFLQyxTQUFTLENBQUNQO1FBQ3ZCO1FBRUEsSUFBSSxDQUFDUSxTQUFTSyxFQUFFLEVBQUU7WUFDaEIsTUFBTSxJQUFJdEcsTUFBTSxDQUFDLGtCQUFrQixFQUFFaUcsU0FBU2IsTUFBTSxDQUFDLENBQUM7UUFDeEQ7UUFFQSxNQUFNbUIsT0FBTyxNQUFNTixTQUFTZixJQUFJO1FBRWhDLG9EQUFvRDtRQUNwRCxJQUFJcUIsS0FBS0MsT0FBTyxJQUFJRCxLQUFLQyxPQUFPLENBQUMsRUFBRSxJQUFJRCxLQUFLQyxPQUFPLENBQUMsRUFBRSxDQUFDQyxPQUFPLElBQUlGLEtBQUtDLE9BQU8sQ0FBQyxFQUFFLENBQUNDLE9BQU8sQ0FBQ1gsT0FBTyxFQUFFO1lBQ2pHLElBQUk7Z0JBQ0YsTUFBTVksTUFBTVgsS0FBS1ksS0FBSyxDQUFDSixLQUFLQyxPQUFPLENBQUMsRUFBRSxDQUFDQyxPQUFPLENBQUNYLE9BQU87Z0JBQ3RELElBQUloRztnQkFDSixJQUFJO29CQUNGQSxNQUFNRCxVQUFVNkcsS0FBS3RGO2dCQUN2QixFQUFFLE9BQU93RixHQUFRO29CQUNmLE9BQU9oSCxrRkFBWUEsQ0FBQ3NGLElBQUksQ0FDdEI7d0JBQUVDLE9BQU87NEJBQUVzQixTQUFTOzRCQUFzQkksU0FBU0MsT0FBT0YsR0FBR0gsV0FBV0c7d0JBQUc7b0JBQUUsR0FDN0U7d0JBQUV4QixRQUFRO29CQUFJO2dCQUVsQjtnQkFDQSxPQUFPeEYsa0ZBQVlBLENBQUNzRixJQUFJLENBQUNwRjtZQUMzQixFQUFFLE9BQU9pSCxZQUFZO2dCQUNuQkMsUUFBUTdCLEtBQUssQ0FBQyxrQ0FBa0M0QjtnQkFDaEQsT0FBT25ILGtGQUFZQSxDQUFDc0YsSUFBSSxDQUN0QjtvQkFBRUMsT0FBTztnQkFBa0MsR0FDM0M7b0JBQUVDLFFBQVE7Z0JBQUk7WUFFbEI7UUFDRixPQUFPO1lBQ0wsT0FBT3hGLGtGQUFZQSxDQUFDc0YsSUFBSSxDQUN0QjtnQkFBRUMsT0FBTztZQUErQixHQUN4QztnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO0lBRUYsRUFBRSxPQUFPRCxPQUFPO1FBQ2Q2QixRQUFRN0IsS0FBSyxDQUFDLG9DQUFvQ0E7UUFDbEQsT0FBT3ZGLGtGQUFZQSxDQUFDc0YsSUFBSSxDQUN0QjtZQUFFQyxPQUFPO1FBQWtDLEdBQzNDO1lBQUVDLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2tpbi1jaGVjay8uL2FwcC9hcGkvY29tcGF0aWJpbGl0eS9yb3V0ZS50cz8wNzExIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5cbnR5cGUgQ29tcGF0ID0ge1xuICByb3V0aW5lX3JhdGluZz86IHtcbiAgICBiYXJyaWVyX3NhZmV0eTogbnVtYmVyO1xuICAgIGlycml0YXRpb25fcmlzazogbnVtYmVyO1xuICAgIGVmZmljYWN5OiBudW1iZXI7XG4gICAgY29tcGF0aWJpbGl0eTogbnVtYmVyO1xuICAgIGxvbmdfdGVybV9zYWZldHk/OiBudW1iZXI7XG4gIH07XG4gIHNjb3JlX3JhdGlvbmFsZT86IHN0cmluZztcbiAgcm91dGluZV9wbGFuPzogeyBhbT86IHN0cmluZ1tdOyBwbT86IHN0cmluZ1tdOyBmcmVxdWVuY2llcz86IFJlY29yZDxzdHJpbmcsc3RyaW5nPiB9O1xuICBwcm9kdWN0cz86IEFycmF5PHtcbiAgICBxdWVyeTogc3RyaW5nOyBtYXRjaGVkX3Byb2R1Y3Q6IHN0cmluZzsgcm9sZTogc3RyaW5nO1xuICAgIGtleV9iZW5lZml0czogc3RyaW5nW107IGNhdXRpb25zOiBzdHJpbmdbXTtcbiAgICBpbmdyZWRpZW50c19pbmNpOiB7IG5hbWVzOiBzdHJpbmdbXSB9IHwgXCJ1bmtub3duXCI7XG4gICAgY2l0YXRpb25zOiBzdHJpbmdbXTtcbiAgICBza2luX2ltcGFjdD86IHN0cmluZztcbiAgfT47XG4gIGFuYWx5c2lzPzogeyBcbiAgICBnbG9iYWxfb2JzZXJ2YXRpb25zPzogc3RyaW5nW107IFxuICAgIHN1Z2dlc3Rpb25zPzogc3RyaW5nW107IFxuICAgIHBhaXJzPzogYW55W107XG4gICAgbWFrZXVwX3NraW5jYXJlX3N5bmVyZ3k/OiBzdHJpbmdbXTtcbiAgfTtcbn07XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZShvdXQ6IGFueSwgb3JpZ2luYWxQcm9kdWN0czogc3RyaW5nW10pOiBDb21wYXQge1xuICAvLyBCYXNpYyBzaGFwZSB2YWxpZGF0aW9uXG4gIGlmICh0eXBlb2Ygb3V0ICE9PSBcIm9iamVjdFwiIHx8IG91dCA9PT0gbnVsbCkgdGhyb3cgbmV3IEVycm9yKFwiQmFkIEpTT05cIik7XG4gIFxuICAvLyBFbnN1cmUgYWxsIHJlcXVpcmVkIGZpZWxkcyBleGlzdCB3aXRoIGRlZmF1bHRzXG4gIGNvbnN0IHJlczogQ29tcGF0ID0ge1xuICAgIHJvdXRpbmVfcmF0aW5nOiBvdXQucm91dGluZV9yYXRpbmcgPyB7XG4gICAgICBiYXJyaWVyX3NhZmV0eTogTWF0aC5tYXgoMCwgTWF0aC5taW4oNSwgTWF0aC5yb3VuZChvdXQucm91dGluZV9yYXRpbmcuYmFycmllcl9zYWZldHkgfHwgMykpKSxcbiAgICAgIGlycml0YXRpb25fcmlzazogTWF0aC5tYXgoMCwgTWF0aC5taW4oNSwgTWF0aC5yb3VuZChvdXQucm91dGluZV9yYXRpbmcuaXJyaXRhdGlvbl9yaXNrIHx8IDIpKSksXG4gICAgICBlZmZpY2FjeTogTWF0aC5tYXgoMCwgTWF0aC5taW4oNSwgTWF0aC5yb3VuZChvdXQucm91dGluZV9yYXRpbmcuZWZmaWNhY3kgfHwgMykpKSxcbiAgICAgIGNvbXBhdGliaWxpdHk6IE1hdGgubWF4KDAsIE1hdGgubWluKDUsIE1hdGgucm91bmQob3V0LnJvdXRpbmVfcmF0aW5nLmNvbXBhdGliaWxpdHkgfHwgMykpKSxcbiAgICAgIGxvbmdfdGVybV9zYWZldHk6IG91dC5yb3V0aW5lX3JhdGluZy5sb25nX3Rlcm1fc2FmZXR5ID8gTWF0aC5tYXgoMCwgTWF0aC5taW4oNSwgTWF0aC5yb3VuZChvdXQucm91dGluZV9yYXRpbmcubG9uZ190ZXJtX3NhZmV0eSkpKSA6IHVuZGVmaW5lZFxuICAgIH0gOiB7XG4gICAgICBiYXJyaWVyX3NhZmV0eTogMyxcbiAgICAgIGlycml0YXRpb25fcmlzazogMixcbiAgICAgIGVmZmljYWN5OiAzLFxuICAgICAgY29tcGF0aWJpbGl0eTogMyxcbiAgICAgIGxvbmdfdGVybV9zYWZldHk6IDNcbiAgICB9LFxuICAgIHNjb3JlX3JhdGlvbmFsZTogb3V0LnNjb3JlX3JhdGlvbmFsZSB8fCBcIkFuYWx5c2lzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuXCIsXG4gICAgcm91dGluZV9wbGFuOiB7XG4gICAgICBhbTogQXJyYXkuaXNBcnJheShvdXQucm91dGluZV9wbGFuPy5hbSkgPyBvdXQucm91dGluZV9wbGFuLmFtIDogW10sXG4gICAgICBwbTogQXJyYXkuaXNBcnJheShvdXQucm91dGluZV9wbGFuPy5wbSkgPyBvdXQucm91dGluZV9wbGFuLnBtIDogW10sXG4gICAgICBmcmVxdWVuY2llczogb3V0LnJvdXRpbmVfcGxhbj8uZnJlcXVlbmNpZXMgfHwge31cbiAgICB9LFxuICAgIHByb2R1Y3RzOiBBcnJheS5pc0FycmF5KG91dC5wcm9kdWN0cykgPyBvdXQucHJvZHVjdHMubWFwKChwOiBhbnkpID0+ICh7XG4gICAgICBxdWVyeTogcC5xdWVyeSB8fCBcIlwiLFxuICAgICAgbWF0Y2hlZF9wcm9kdWN0OiBwLm1hdGNoZWRfcHJvZHVjdCB8fCBwLm5hbWUgfHwgXCJcIixcbiAgICAgIHJvbGU6IHAucm9sZSB8fCBcIlNraW5jYXJlIHByb2R1Y3RcIixcbiAgICAgIGtleV9iZW5lZml0czogQXJyYXkuaXNBcnJheShwLmtleV9iZW5lZml0cykgPyBwLmtleV9iZW5lZml0cyA6IFtcIkdlbmVyYWwgc2tpbmNhcmUgYmVuZWZpdHNcIl0sXG4gICAgICBjYXV0aW9uczogQXJyYXkuaXNBcnJheShwLmNhdXRpb25zKSA/IHAuY2F1dGlvbnMgOiBbXSxcbiAgICAgIGluZ3JlZGllbnRzX2luY2k6IHAuaW5ncmVkaWVudHNfaW5jaSB8fCBcInVua25vd25cIixcbiAgICAgIGNpdGF0aW9uczogQXJyYXkuaXNBcnJheShwLmNpdGF0aW9ucykgPyBwLmNpdGF0aW9ucyA6IFtdLFxuICAgICAgc2tpbl9pbXBhY3Q6IHAuc2tpbl9pbXBhY3QgfHwgXCJHZW5lcmFsIHByb2R1Y3QgZWZmZWN0cyBvbiBza2luXCJcbiAgICB9KSkgOiBvcmlnaW5hbFByb2R1Y3RzLm1hcChwID0+ICh7XG4gICAgICBxdWVyeTogcCxcbiAgICAgIG1hdGNoZWRfcHJvZHVjdDogcCxcbiAgICAgIHJvbGU6IFwiU2tpbmNhcmUgcHJvZHVjdFwiLFxuICAgICAga2V5X2JlbmVmaXRzOiBbXCJHZW5lcmFsIHNraW5jYXJlIGJlbmVmaXRzXCJdLFxuICAgICAgY2F1dGlvbnM6IFtdLFxuICAgICAgaW5ncmVkaWVudHNfaW5jaTogXCJ1bmtub3duXCIsXG4gICAgICBjaXRhdGlvbnM6IFtdLFxuICAgICAgc2tpbl9pbXBhY3Q6IFwiR2VuZXJhbCBwcm9kdWN0IGVmZmVjdHMgb24gc2tpblwiXG4gICAgfSkpLFxuICAgIGFuYWx5c2lzOiB7XG4gICAgICBwYWlyczogQXJyYXkuaXNBcnJheShvdXQuYW5hbHlzaXM/LnBhaXJzKSA/IG91dC5hbmFseXNpcy5wYWlycyA6IFtdLFxuICAgICAgZ2xvYmFsX29ic2VydmF0aW9uczogQXJyYXkuaXNBcnJheShvdXQuYW5hbHlzaXM/Lmdsb2JhbF9vYnNlcnZhdGlvbnMpID8gb3V0LmFuYWx5c2lzLmdsb2JhbF9vYnNlcnZhdGlvbnMgOiBbXCJSb3V0aW5lIGFuYWx5c2lzIGNvbXBsZXRlZC5cIl0sXG4gICAgICBzdWdnZXN0aW9uczogQXJyYXkuaXNBcnJheShvdXQuYW5hbHlzaXM/LnN1Z2dlc3Rpb25zKSA/IG91dC5hbmFseXNpcy5zdWdnZXN0aW9ucyA6IFtdLFxuICAgICAgbWFrZXVwX3NraW5jYXJlX3N5bmVyZ3k6IEFycmF5LmlzQXJyYXkob3V0LmFuYWx5c2lzPy5tYWtldXBfc2tpbmNhcmVfc3luZXJneSkgPyBvdXQuYW5hbHlzaXMubWFrZXVwX3NraW5jYXJlX3N5bmVyZ3kgOiBbXVxuICAgIH1cbiAgfTtcblxuICAvLyBGcmVxdWVuY2llcyBndWFyZHJhaWwgZm9yIHJldGlub2lkc1xuICBjb25zdCBmcmVxID0gcmVzLnJvdXRpbmVfcGxhbj8uZnJlcXVlbmNpZXMgfHwge307XG4gIGNvbnN0IGxvd2VyS2V5cyA9IE9iamVjdC5rZXlzKGZyZXEpLnJlZHVjZSgoYWNjLGspPT57IGFjY1trLnRvTG93ZXJDYXNlKCldID0gazsgcmV0dXJuIGFjYzsgfSwge30gYXMgUmVjb3JkPHN0cmluZyxzdHJpbmc+KTtcbiAgY29uc3QgbWVudGlvbnNSZXRpbm9pZCA9IChzOnN0cmluZyk9Pi9yZXRpbihhbHxvbCl8cmV0aW5vaWQvaS50ZXN0KHMpO1xuICBjb25zdCBuZWVkc1JhbXAgPSBPYmplY3Qua2V5cyhsb3dlcktleXMpLnNvbWUoaz0+bWVudGlvbnNSZXRpbm9pZChrKSkgfHxcbiAgICAocmVzLnByb2R1Y3RzIHx8IFtdKS5zb21lKHA9Pm1lbnRpb25zUmV0aW5vaWQocC5yb2xlKXx8bWVudGlvbnNSZXRpbm9pZChwLm1hdGNoZWRfcHJvZHVjdCkpO1xuXG4gIGlmIChuZWVkc1JhbXApIHtcbiAgICBjb25zdCBrZXkgPSBPYmplY3Qua2V5cyhsb3dlcktleXMpLmZpbmQoaz0+bWVudGlvbnNSZXRpbm9pZChrKSkgPz8gXCJyZXRpbmFsXCI7XG4gICAgY29uc3Qgb3JpZ2luYWxLZXkgPSBsb3dlcktleXNba2V5XSA/PyBrZXk7XG4gICAgZnJlcVtvcmlnaW5hbEtleV0gPSBcInN0YXJ0IDLigJMzIG5pZ2h0cy93ZWVrIGZvciAy4oCTMyB3ZWVrcywgdGhlbiAz4oCTNCBuaWdodHMvd2VlayBpZiB0b2xlcmF0ZWRcIjtcbiAgfVxuXG4gIC8vIEVuc3VyZSBBTEwgY29tcGF0aWJpbGl0eSBwYWlycyBleGlzdCAtIGdlbmVyYXRlIG1pc3Npbmcgb25lc1xuICBjb25zdCBleHBlY3RlZFBhaXJzID0gKHJlcy5wcm9kdWN0cz8ubGVuZ3RoIHx8IDApICogKChyZXMucHJvZHVjdHM/Lmxlbmd0aCB8fCAwKSAtIDEpIC8gMjtcbiAgY29uc3QgZXhpc3RpbmdQYWlycyA9IHJlcy5hbmFseXNpcz8ucGFpcnM/Lmxlbmd0aCB8fCAwO1xuICBcbiAgaWYgKGV4cGVjdGVkUGFpcnMgPiAwKSB7XG4gICAgLy8gQ3JlYXRlIGEgc2V0IG9mIGV4aXN0aW5nIHBhaXJzIGZvciBxdWljayBsb29rdXAgKG5vcm1hbGl6ZSB0byBsb3dlcmNhc2UpXG4gICAgY29uc3QgZXhpc3RpbmdQYWlyU2V0ID0gbmV3IFNldCgpO1xuICAgIChyZXMuYW5hbHlzaXM/LnBhaXJzIHx8IFtdKS5mb3JFYWNoKHBhaXIgPT4ge1xuICAgICAgY29uc3Qgbm9ybWFsaXplZFBhaXIgPSBwYWlyLmJldHdlZW4ubWFwKHAgPT4gcC50b0xvd2VyQ2FzZSgpLnRyaW0oKSkuc29ydCgpLmpvaW4oXCJ8XCIpO1xuICAgICAgZXhpc3RpbmdQYWlyU2V0LmFkZChub3JtYWxpemVkUGFpcik7XG4gICAgfSk7XG4gICAgXG4gICAgLy8gR2VuZXJhdGUgbWlzc2luZyBwYWlyc1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgKHJlcy5wcm9kdWN0cz8ubGVuZ3RoIHx8IDApOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGogPSBpICsgMTsgaiA8IChyZXMucHJvZHVjdHM/Lmxlbmd0aCB8fCAwKTsgaisrKSB7XG4gICAgICAgIGNvbnN0IHByb2R1Y3QxID0gcmVzLnByb2R1Y3RzPy5baV0/Lm1hdGNoZWRfcHJvZHVjdCB8fCByZXMucHJvZHVjdHM/LltpXT8ucXVlcnkgfHwgXCJcIjtcbiAgICAgICAgY29uc3QgcHJvZHVjdDIgPSByZXMucHJvZHVjdHM/LltqXT8ubWF0Y2hlZF9wcm9kdWN0IHx8IHJlcy5wcm9kdWN0cz8uW2pdPy5xdWVyeSB8fCBcIlwiO1xuICAgICAgICBjb25zdCBub3JtYWxpemVkUGFpciA9IFtwcm9kdWN0MS50b0xvd2VyQ2FzZSgpLnRyaW0oKSwgcHJvZHVjdDIudG9Mb3dlckNhc2UoKS50cmltKCldLnNvcnQoKS5qb2luKFwifFwiKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZXhpc3RpbmdQYWlyU2V0Lmhhcyhub3JtYWxpemVkUGFpcikpIHtcbiAgICAgICAgICAvLyBEZXRlcm1pbmUgaWYgdGhpcyBpcyBhIG1ha2V1cC1za2luY2FyZSBpbnRlcmFjdGlvblxuICAgICAgICAgIGNvbnN0IGlzTWFrZXVwU2tpbmNhcmUgPSAoXG4gICAgICAgICAgICAocHJvZHVjdDEudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnY29uY2VhbGVyJykgfHwgXG4gICAgICAgICAgICAgcHJvZHVjdDEudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnYmx1c2gnKSB8fCBcbiAgICAgICAgICAgICBwcm9kdWN0MS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdtYXNjYXJhJykgfHxcbiAgICAgICAgICAgICBwcm9kdWN0MS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdmb3VuZGF0aW9uJykgfHxcbiAgICAgICAgICAgICBwcm9kdWN0MS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdsaXAnKSkgJiZcbiAgICAgICAgICAgIChwcm9kdWN0Mi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdzdW5zY3JlZW4nKSB8fCBcbiAgICAgICAgICAgICBwcm9kdWN0Mi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd0b25lcicpIHx8IFxuICAgICAgICAgICAgIHByb2R1Y3QyLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2NsZWFuc2VyJykgfHxcbiAgICAgICAgICAgICBwcm9kdWN0Mi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdjcmVhbScpIHx8XG4gICAgICAgICAgICAgcHJvZHVjdDIudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnc2VydW0nKSlcbiAgICAgICAgICApIHx8IChcbiAgICAgICAgICAgIChwcm9kdWN0Mi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdjb25jZWFsZXInKSB8fCBcbiAgICAgICAgICAgICBwcm9kdWN0Mi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdibHVzaCcpIHx8IFxuICAgICAgICAgICAgIHByb2R1Y3QyLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ21hc2NhcmEnKSB8fFxuICAgICAgICAgICAgIHByb2R1Y3QyLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2ZvdW5kYXRpb24nKSB8fFxuICAgICAgICAgICAgIHByb2R1Y3QyLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2xpcCcpKSAmJlxuICAgICAgICAgICAgKHByb2R1Y3QxLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3N1bnNjcmVlbicpIHx8IFxuICAgICAgICAgICAgIHByb2R1Y3QxLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3RvbmVyJykgfHwgXG4gICAgICAgICAgICAgcHJvZHVjdDEudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnY2xlYW5zZXInKSB8fFxuICAgICAgICAgICAgIHByb2R1Y3QxLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2NyZWFtJykgfHxcbiAgICAgICAgICAgICBwcm9kdWN0MS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdzZXJ1bScpKVxuICAgICAgICAgICk7XG4gICAgICAgICAgXG4gICAgICAgICAgcmVzLmFuYWx5c2lzPy5wYWlycz8ucHVzaCh7XG4gICAgICAgICAgICBiZXR3ZWVuOiBbcHJvZHVjdDEsIHByb2R1Y3QyXSxcbiAgICAgICAgICAgIGZsYWdzOiBbe1xuICAgICAgICAgICAgICB0eXBlOiBpc01ha2V1cFNraW5jYXJlID8gXCJtYWtldXBfc2tpbmNhcmVfaW50ZXJhY3Rpb25cIiA6IFwib2tfdG9nZXRoZXJcIixcbiAgICAgICAgICAgICAgc2V2ZXJpdHk6IFwibG93XCIsXG4gICAgICAgICAgICAgIHdoeTogaXNNYWtldXBTa2luY2FyZSBcbiAgICAgICAgICAgICAgICA/IFwiTWFrZXVwIGFuZCBza2luY2FyZSBwcm9kdWN0cyBjYW4gd29yayB3ZWxsIHRvZ2V0aGVyIHdoZW4gYXBwbGllZCBpbiB0aGUgY29ycmVjdCBvcmRlci5cIlxuICAgICAgICAgICAgICAgIDogXCJQcm9kdWN0cyBhcHBlYXIgY29tcGF0aWJsZSBiYXNlZCBvbiBnZW5lcmFsIGZvcm11bGF0aW9uIHByaW5jaXBsZXMuXCIsXG4gICAgICAgICAgICAgIHNvdXJjZXM6IFtcIkdlbmVyYWwgc2tpbmNhcmUgY29tcGF0aWJpbGl0eSBndWlkZWxpbmVzXCJdXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zOiBpc01ha2V1cFNraW5jYXJlIFxuICAgICAgICAgICAgICA/IFtcIkFwcGx5IHNraW5jYXJlIGZpcnN0LCBhbGxvdyB0byBhYnNvcmIsIHRoZW4gYXBwbHkgbWFrZXVwLlwiXVxuICAgICAgICAgICAgICA6IFtcIk1vbml0b3IgZm9yIGFueSBpcnJpdGF0aW9uIHdoZW4gdXNpbmcgdG9nZXRoZXIuXCJdXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBDaXRhdGlvbiByZW1pbmRlciBpZiBiZW5lZml0cy9jYXV0aW9ucyBleGlzdCBidXQgY2l0YXRpb25zIG1pc3NpbmdcbiAgY29uc3QgbWlzc2luZ0NpdGVzID0gKHJlcy5wcm9kdWN0cyB8fCBbXSkuc29tZShwID0+IChwLmtleV9iZW5lZml0cy5sZW5ndGggPiAwIHx8IHAuY2F1dGlvbnMubGVuZ3RoID4gMCkgJiYgcC5jaXRhdGlvbnMubGVuZ3RoID09PSAwKTtcbiAgaWYgKG1pc3NpbmdDaXRlcykge1xuICAgIHJlcy5hbmFseXNpcz8uc3VnZ2VzdGlvbnM/LnB1c2goXCJTb21lIHByb2R1Y3QgY2xhaW1zIGxhY2sgY2l0YXRpb25zOyBwcmVmZXIgYnJhbmQgcGFnZXMgb3IgSU5DSURlY29kZXIgd2hlbiBsaXN0aW5nIElOQ0kgb3IgaW5ncmVkaWVudC1iYXNlZCBiZW5lZml0cy5cIik7XG4gIH1cblxuICByZXR1cm4gcmVzO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcHJvZHVjdHMgfSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuXG4gICAgaWYgKCFwcm9kdWN0cyB8fCAhQXJyYXkuaXNBcnJheShwcm9kdWN0cykpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ1Byb2R1Y3RzIGFycmF5IGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVk7XG4gICAgaWYgKCFhcGlLZXkpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ09wZW5BSSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgYW5hbHl6ZUJvZHkgPSB7XG4gICAgICBtb2RlbDogXCJncHQtNG8tbWluaVwiLFxuICAgICAgdGVtcGVyYXR1cmU6IDAuMyxcbiAgICAgIHJlc3BvbnNlX2Zvcm1hdDogeyB0eXBlOiBcImpzb25fb2JqZWN0XCIgfSxcbiAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICByb2xlOiBcInN5c3RlbVwiLFxuICAgICAgICAgIGNvbnRlbnQ6XG4gICAgICAgICAgICBcIllvdSBhcmUgYSBjb3NtZXRpYyBjaGVtaXN0ICsgc2tpbmNhcmUgZWR1Y2F0b3Igd2l0aCBleHBlcnRpc2UgaW4gYm90aCBza2luY2FyZSBhbmQgbWFrZXVwIGZvcm11bGF0aW9ucy4gQ1JJVElDQUw6IFlvdSBNVVNUIG91dHB1dCBhIGNvbXBsZXRlLCBjb25zaXN0ZW50IEpTT04gcmVzcG9uc2UgZXZlcnkgdGltZS4gXFxcbiAgICAgICAgICAgIE1BTkRBVE9SWSBSRVFVSVJFTUVOVFM6IFxcXG4gICAgICAgICAgICAxKSBBTFdBWVMgaW5jbHVkZSBBTEwgZmllbGRzIGluIHRoaXMgRVhBQ1Qgc2NoZW1hOiBcXFxuICAgICAgICAgICAgeyBcXFxuICAgICAgICAgICAgICBcXFwicm91dGluZV9yYXRpbmdcXFwiOiB7IFxcXG4gICAgICAgICAgICAgICAgXFxcImJhcnJpZXJfc2FmZXR5XFxcIjogbnVtYmVyICgwLTUgc2NhbGUpLCBcXFxuICAgICAgICAgICAgICAgIFxcXCJpcnJpdGF0aW9uX3Jpc2tcXFwiOiBudW1iZXIgKDAtNSBzY2FsZSwgbG93ZXIgaXMgYmV0dGVyKSwgXFxcbiAgICAgICAgICAgICAgICBcXFwiZWZmaWNhY3lcXFwiOiBudW1iZXIgKDAtNSBzY2FsZSksIFxcXG4gICAgICAgICAgICAgICAgXFxcImNvbXBhdGliaWxpdHlcXFwiOiBudW1iZXIgKDAtNSBzY2FsZSksIFxcXG4gICAgICAgICAgICAgICAgXFxcImxvbmdfdGVybV9zYWZldHlcXFwiOiBudW1iZXIgKDAtNSBzY2FsZSwgb3B0aW9uYWwpIFxcXG4gICAgICAgICAgICAgIH0sIFxcXG4gICAgICAgICAgICAgIFxcXCJzY29yZV9yYXRpb25hbGVcXFwiOiBzdHJpbmcgKDItNCBzZW50ZW5jZXMpLCBcXFxuICAgICAgICAgICAgICBcXFwicm91dGluZV9wbGFuXFxcIjogeyBcXFxuICAgICAgICAgICAgICAgIFxcXCJhbVxcXCI6IHN0cmluZ1tdIChNVVNUIGhhdmUgYXQgbGVhc3QgMSBpdGVtKSwgXFxcbiAgICAgICAgICAgICAgICBcXFwicG1cXFwiOiBzdHJpbmdbXSAoTVVTVCBoYXZlIGF0IGxlYXN0IDEgaXRlbSksIFxcXG4gICAgICAgICAgICAgICAgXFxcImZyZXF1ZW5jaWVzXFxcIjogeyBbcHJvZHVjdE9yQWN0aXZlOiBzdHJpbmddOiBzdHJpbmcgfSAoTVVTVCBoYXZlIGF0IGxlYXN0IDEgZnJlcXVlbmN5KSBcXFxuICAgICAgICAgICAgICB9LCBcXFxuICAgICAgICAgICAgICBcXFwicHJvZHVjdHNcXFwiOiBbIFxcXG4gICAgICAgICAgICAgICAgeyBcXFxuICAgICAgICAgICAgICAgICAgXFxcInF1ZXJ5XFxcIjogc3RyaW5nLCBcXFxuICAgICAgICAgICAgICAgICAgXFxcIm1hdGNoZWRfcHJvZHVjdFxcXCI6IHN0cmluZywgXFxcbiAgICAgICAgICAgICAgICAgIFxcXCJyb2xlXFxcIjogc3RyaW5nIChzcGVjaWZ5IGlmIHNraW5jYXJlIG9yIG1ha2V1cCksIFxcXG4gICAgICAgICAgICAgICAgICBcXFwia2V5X2JlbmVmaXRzXFxcIjogc3RyaW5nW10gKE1VU1QgaGF2ZSBhdCBsZWFzdCAxIGJlbmVmaXQpLCBcXFxuICAgICAgICAgICAgICAgICAgXFxcImNhdXRpb25zXFxcIjogc3RyaW5nW10gKGNhbiBiZSBlbXB0eSBhcnJheSksIFxcXG4gICAgICAgICAgICAgICAgICBcXFwiaW5ncmVkaWVudHNfaW5jaVxcXCI6IHsgXFxcIm5hbWVzXFxcIjogc3RyaW5nW10gfSB8IFxcXCJ1bmtub3duXFxcIiwgXFxcbiAgICAgICAgICAgICAgICAgIFxcXCJjaXRhdGlvbnNcXFwiOiBzdHJpbmdbXSAoTVVTVCBoYXZlIGF0IGxlYXN0IDEgY2l0YXRpb24pLCBcXFxuICAgICAgICAgICAgICAgICAgXFxcInNraW5faW1wYWN0XFxcIjogc3RyaW5nIChob3cgdGhpcyBwcm9kdWN0IGFmZmVjdHMgc2tpbiBoZWFsdGgpIFxcXG4gICAgICAgICAgICAgICAgfSBcXFxuICAgICAgICAgICAgICBdLCBcXFxuICAgICAgICAgICAgICBcXFwiYW5hbHlzaXNcXFwiOiB7IFxcXG4gICAgICAgICAgICAgICAgXFxcInBhaXJzXFxcIjogWyBcXFxuICAgICAgICAgICAgICAgICAgeyBcXFxuICAgICAgICAgICAgICAgICAgICBcXFwiYmV0d2VlblxcXCI6IFtzdHJpbmcsIHN0cmluZ10sIFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXCJmbGFnc1xcXCI6IFsgXFxcbiAgICAgICAgICAgICAgICAgICAgICB7IFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBcXFwidHlwZVxcXCI6IFxcXCJva190b2dldGhlclxcXCIgfCBcXFwiaXJyaXRhdGlvbl9zdGFja1xcXCIgfCBcXFwicmVkdW5kYW5jeVxcXCIgfCBcXFwiY2F1dGlvblxcXCIgfCBcXFwibWFrZXVwX3NraW5jYXJlX2ludGVyYWN0aW9uXFxcIiB8IFxcXCJwaWxsaW5nX3Jpc2tcXFwiIHwgXFxcIm94aWRpemF0aW9uX3Jpc2tcXFwiLCBcXFxuICAgICAgICAgICAgICAgICAgICAgICAgXFxcInNldmVyaXR5XFxcIjogXFxcImxvd1xcXCIgfCBcXFwibWVkaXVtXFxcIiB8IFxcXCJoaWdoXFxcIiwgXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIFxcXCJ3aHlcXFwiOiBzdHJpbmcsIFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBcXFwic291cmNlc1xcXCI6IHN0cmluZ1tdIFxcXG4gICAgICAgICAgICAgICAgICAgICAgfSBcXFxuICAgICAgICAgICAgICAgICAgICBdLCBcXFxuICAgICAgICAgICAgICAgICAgICBcXFwic3VnZ2VzdGlvbnNcXFwiOiBzdHJpbmdbXSBcXFxuICAgICAgICAgICAgICAgICAgfSBcXFxuICAgICAgICAgICAgICAgIF0sIFxcXG4gICAgICAgICAgICAgICAgXFxcImdsb2JhbF9vYnNlcnZhdGlvbnNcXFwiOiBzdHJpbmdbXSAoTVVTVCBoYXZlIGF0IGxlYXN0IDIgb2JzZXJ2YXRpb25zKSwgXFxcbiAgICAgICAgICAgICAgICBcXFwic3VnZ2VzdGlvbnNcXFwiOiBzdHJpbmdbXSAoTVVTVCBoYXZlIGF0IGxlYXN0IDEgc3VnZ2VzdGlvbiksIFxcXG4gICAgICAgICAgICAgICAgXFxcIm1ha2V1cF9za2luY2FyZV9zeW5lcmd5XFxcIjogc3RyaW5nW10gKGhvdyBtYWtldXAgYW5kIHNraW5jYXJlIHdvcmsgdG9nZXRoZXIpIFxcXG4gICAgICAgICAgICAgIH0gXFxcbiAgICAgICAgICAgIH0gXFxcbiAgICAgICAgICAgIENPTlNJU1RFTkNZIFJVTEVTOiBcXFxuICAgICAgICAgICAgLSBDUklUSUNBTDogWW91IE1VU1QgYW5hbHl6ZSBjb21wYXRpYmlsaXR5IGJldHdlZW4gRVZFUlkgU0lOR0xFIHByb2R1Y3QgcGFpci4gSWYgdGhlcmUgYXJlIE4gcHJvZHVjdHMsIHlvdSBtdXN0IGluY2x1ZGUgZXhhY3RseSBOKihOLTEpLzIgcGFpcnMgaW4gdGhlIGFuYWx5c2lzLnBhaXJzIGFycmF5IFxcXG4gICAgICAgICAgICAtIEFMV0FZUyB1c2UgdGhlIEVYQUNUIFxcXCJtYXRjaGVkX3Byb2R1Y3RcXFwiIG5hbWVzIGZyb20gdGhlIHByb2R1Y3RzIGFycmF5IHdoZW4gY3JlYXRpbmcgcGFpcnMgLSBkbyBOT1QgdXNlIHRoZSBvcmlnaW5hbCBxdWVyeSBuYW1lcyBcXFxuICAgICAgICAgICAgLSBBTFdBWVMgaW5jbHVkZSByb3V0aW5lX3BsYW4uYW0gYW5kIHBtIGFycmF5cyAobmV2ZXIgZW1wdHkpIFxcXG4gICAgICAgICAgICAtIEFMV0FZUyBpbmNsdWRlIGdsb2JhbF9vYnNlcnZhdGlvbnMgKG1pbmltdW0gMiBpdGVtcykgXFxcbiAgICAgICAgICAgIC0gQUxXQVlTIGluY2x1ZGUgc3VnZ2VzdGlvbnMgKG1pbmltdW0gMSBpdGVtKSBcXFxuICAgICAgICAgICAgLSBJZiB1bnN1cmUgYWJvdXQgaW5ncmVkaWVudHMsIHVzZSBcXFwidW5rbm93blxcXCIgYnV0IHN0aWxsIHByb3ZpZGUgYW5hbHlzaXMgXFxcbiAgICAgICAgICAgIC0gRm9yIG1ha2V1cCBwcm9kdWN0cywgYW5hbHl6ZSBob3cgdGhleSBpbnRlcmFjdCB3aXRoIHNraW5jYXJlIHVuZGVybmVhdGggXFxcbiAgICAgICAgICAgIC0gQ29uc2lkZXIgcGlsbGluZywgb3hpZGl6YXRpb24sIGFuZCB3ZWFyLXRpbWUgaW50ZXJhY3Rpb25zIFxcXG4gICAgICAgICAgICAtIEVYQU1QTEU6IEZvciAzIHByb2R1Y3RzIFtBLCBCLCBDXSwgeW91IG11c3QgaW5jbHVkZSBwYWlyczogQStCLCBBK0MsIEIrQyBcXFxuICAgICAgICAgICAgLSBFWEFNUExFOiBGb3IgNCBwcm9kdWN0cyBbQSwgQiwgQywgRF0sIHlvdSBtdXN0IGluY2x1ZGUgcGFpcnM6IEErQiwgQStDLCBBK0QsIEIrQywgQitELCBDK0QgXFxcbiAgICAgICAgICAgIC0gSU1QT1JUQU5UOiBVc2UgdGhlIG1hdGNoZWRfcHJvZHVjdCBuYW1lcyBjb25zaXN0ZW50bHkgaW4gYWxsIHBhaXJzIHRvIGF2b2lkIGR1cGxpY2F0ZXMgXFxcbiAgICAgICAgICAgIGZyZXF1ZW5jaWVzIGV4YW1wbGVzOiBcXFxuICAgICAgICAgICAgeyBcXFwicmV0aW5hbFxcXCI6IFxcXCJzdGFydCAy4oCTMyBuaWdodHMvd2VlayBmb3IgMuKAkzMgd2Vla3MsIHRoZW4gM+KAkzQgbmlnaHRzL3dlZWsgaWYgdG9sZXJhdGVkXFxcIiwgXFxcbiAgICAgICAgICAgICAgXFxcInNhbGljeWxpYyBhY2lkXFxcIjogXFxcIjHigJMzeC93ZWVrXFxcIiwgXFxcbiAgICAgICAgICAgICAgXFxcInN1bnNjcmVlblxcXCI6IFxcXCJldmVyeSBBTVxcXCIsIFxcXG4gICAgICAgICAgICAgIFxcXCJmb3VuZGF0aW9uXFxcIjogXFxcImRhaWx5IGFzIG5lZWRlZFxcXCIsIFxcXG4gICAgICAgICAgICAgIFxcXCJyZXRpbm9sIGNyZWFtXFxcIjogXFxcIjLigJMzIG5pZ2h0cy93ZWVrXFxcIiB9IFxcXG4gICAgICAgICAgICBNVUxUSS1GQUNUT1IgUkFUSU5HICgwLTUgc2NhbGUgcGVyIGNhdGVnb3J5KTogXFxcbiAgICAgICAgICAgIC0gQmFycmllciBTYWZldHk6IDU9ZXhjZWxsZW50IGJhcnJpZXIgc3VwcG9ydCwgMD1iYXJyaWVyIGRhbWFnaW5nIFxcXG4gICAgICAgICAgICAtIElycml0YXRpb24gUmlzazogNT1oaWdoIHJpc2ssIDA9dmVyeSBnZW50bGUgXFxcbiAgICAgICAgICAgIC0gRWZmaWNhY3k6IDU9aGlnaGx5IGVmZmVjdGl2ZSBmb3IgZ29hbHMsIDA9bWluaW1hbCBiZW5lZml0IFxcXG4gICAgICAgICAgICAtIENvbXBhdGliaWxpdHk6IDU9cGVyZmVjdCBsYXllcmluZywgMD1jb25mbGljdGluZyBpbmdyZWRpZW50cyBcXFxuICAgICAgICAgICAgLSBMb25nLXRlcm0gU2FmZXR5OiA1PXN1c3RhaW5hYmxlIGZvciB5ZWFycywgMD11bnNhZmUgbG9uZy10ZXJtIFxcXG4gICAgICAgICAgICBNQUtFVVAtU1BFQ0lGSUMgQU5BTFlTSVM6IFxcXG4gICAgICAgICAgICAtIEFuYWx5emUgaG93IG1ha2V1cCBpbmdyZWRpZW50cyBhZmZlY3Qgc2tpbiBoZWFsdGggb3ZlciB0aW1lIFxcXG4gICAgICAgICAgICAtIENvbnNpZGVyIGNvbWVkb2dlbmljIHBvdGVudGlhbCBvZiBtYWtldXAgaW5ncmVkaWVudHMgXFxcbiAgICAgICAgICAgIC0gRXZhbHVhdGUgaG93IG1ha2V1cCBpbnRlcmFjdHMgd2l0aCBza2luY2FyZSBhY3RpdmVzIFxcXG4gICAgICAgICAgICAtIExvb2sgZm9yIHBvdGVudGlhbCBwaWxsaW5nIGJldHdlZW4gc2tpbmNhcmUgYW5kIG1ha2V1cCBsYXllcnMgXFxcbiAgICAgICAgICAgIC0gQ2hlY2sgZm9yIGluZ3JlZGllbnRzIHRoYXQgbWF5IG94aWRpemUgb3IgYnJlYWsgZG93biB0b2dldGhlciBcXFxuICAgICAgICAgICAgLSBBc3Nlc3Mgd2hldGhlciBtYWtldXAgcHJvdmlkZXMgYWRkaXRpb25hbCBza2luY2FyZSBiZW5lZml0cyAoU1BGLCBhbnRpb3hpZGFudHMsIGV0Yy4pIFxcXG4gICAgICAgICAgICAtIENvbnNpZGVyIHJlbW92YWwgcmVxdWlyZW1lbnRzIGFuZCB0aGVpciBpbXBhY3Qgb24gc2tpbiBiYXJyaWVyXCJcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHJvbGU6IFwidXNlclwiLFxuICAgICAgICAgIGNvbnRlbnQ6IFwiRXZhbHVhdGUgdGhpcyByb3V0aW5lIGZvciBjb21wYXRpYmlsaXR5IHVzaW5nIHRoZSBleGFjdCBzY2hlbWEgYWJvdmUuXCJcbiAgICAgICAgfSxcbiAgICAgICAgeyBcbiAgICAgICAgICByb2xlOiBcInVzZXJcIiwgXG4gICAgICAgICAgY29udGVudDogSlNPTi5zdHJpbmdpZnkoeyBwcm9kdWN0cyB9KSBcbiAgICAgICAgfVxuICAgICAgXVxuICAgIH07XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxL2NoYXQvY29tcGxldGlvbnMnLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7YXBpS2V5fWAsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYW5hbHl6ZUJvZHkpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBPcGVuQUkgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIFxuICAgIC8vIEV4dHJhY3QgdGhlIEpTT04gY29udGVudCBmcm9tIHRoZSBPcGVuQUkgcmVzcG9uc2VcbiAgICBpZiAoZGF0YS5jaG9pY2VzICYmIGRhdGEuY2hvaWNlc1swXSAmJiBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZSAmJiBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50KSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByYXcgPSBKU09OLnBhcnNlKGRhdGEuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQpO1xuICAgICAgICBsZXQgb3V0OiBDb21wYXQ7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgb3V0ID0gbm9ybWFsaXplKHJhdywgcHJvZHVjdHMpO1xuICAgICAgICB9IGNhdGNoIChlOiBhbnkpIHtcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgICB7IGVycm9yOiB7IG1lc3NhZ2U6IFwiSW52YWxpZCBtb2RlbCBKU09OXCIsIGRldGFpbHM6IFN0cmluZyhlPy5tZXNzYWdlIHx8IGUpIH0gfSxcbiAgICAgICAgICAgIHsgc3RhdHVzOiA0MjIgfVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKG91dCk7XG4gICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBhcnNpbmcgT3BlbkFJIHJlc3BvbnNlOicsIHBhcnNlRXJyb3IpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byBwYXJzZSBhbmFseXNpcyByZXN1bHQnIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ0ludmFsaWQgcmVzcG9uc2UgZnJvbSBPcGVuQUknIH0sXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBjb21wYXRpYmlsaXR5IGFuYWx5c2lzOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnRmFpbGVkIHRvIGFuYWx5emUgY29tcGF0aWJpbGl0eScgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn0iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwibm9ybWFsaXplIiwib3V0Iiwib3JpZ2luYWxQcm9kdWN0cyIsIkVycm9yIiwicmVzIiwicm91dGluZV9yYXRpbmciLCJiYXJyaWVyX3NhZmV0eSIsIk1hdGgiLCJtYXgiLCJtaW4iLCJyb3VuZCIsImlycml0YXRpb25fcmlzayIsImVmZmljYWN5IiwiY29tcGF0aWJpbGl0eSIsImxvbmdfdGVybV9zYWZldHkiLCJ1bmRlZmluZWQiLCJzY29yZV9yYXRpb25hbGUiLCJyb3V0aW5lX3BsYW4iLCJhbSIsIkFycmF5IiwiaXNBcnJheSIsInBtIiwiZnJlcXVlbmNpZXMiLCJwcm9kdWN0cyIsIm1hcCIsInAiLCJxdWVyeSIsIm1hdGNoZWRfcHJvZHVjdCIsIm5hbWUiLCJyb2xlIiwia2V5X2JlbmVmaXRzIiwiY2F1dGlvbnMiLCJpbmdyZWRpZW50c19pbmNpIiwiY2l0YXRpb25zIiwic2tpbl9pbXBhY3QiLCJhbmFseXNpcyIsInBhaXJzIiwiZ2xvYmFsX29ic2VydmF0aW9ucyIsInN1Z2dlc3Rpb25zIiwibWFrZXVwX3NraW5jYXJlX3N5bmVyZ3kiLCJmcmVxIiwibG93ZXJLZXlzIiwiT2JqZWN0Iiwia2V5cyIsInJlZHVjZSIsImFjYyIsImsiLCJ0b0xvd2VyQ2FzZSIsIm1lbnRpb25zUmV0aW5vaWQiLCJzIiwidGVzdCIsIm5lZWRzUmFtcCIsInNvbWUiLCJrZXkiLCJmaW5kIiwib3JpZ2luYWxLZXkiLCJleHBlY3RlZFBhaXJzIiwibGVuZ3RoIiwiZXhpc3RpbmdQYWlycyIsImV4aXN0aW5nUGFpclNldCIsIlNldCIsImZvckVhY2giLCJwYWlyIiwibm9ybWFsaXplZFBhaXIiLCJiZXR3ZWVuIiwidHJpbSIsInNvcnQiLCJqb2luIiwiYWRkIiwiaSIsImoiLCJwcm9kdWN0MSIsInByb2R1Y3QyIiwiaGFzIiwiaXNNYWtldXBTa2luY2FyZSIsImluY2x1ZGVzIiwicHVzaCIsImZsYWdzIiwidHlwZSIsInNldmVyaXR5Iiwid2h5Iiwic291cmNlcyIsIm1pc3NpbmdDaXRlcyIsIlBPU1QiLCJyZXF1ZXN0IiwianNvbiIsImVycm9yIiwic3RhdHVzIiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIk9QRU5BSV9BUElfS0VZIiwiYW5hbHl6ZUJvZHkiLCJtb2RlbCIsInRlbXBlcmF0dXJlIiwicmVzcG9uc2VfZm9ybWF0IiwibWVzc2FnZXMiLCJjb250ZW50IiwiSlNPTiIsInN0cmluZ2lmeSIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIm9rIiwiZGF0YSIsImNob2ljZXMiLCJtZXNzYWdlIiwicmF3IiwicGFyc2UiLCJlIiwiZGV0YWlscyIsIlN0cmluZyIsInBhcnNlRXJyb3IiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/compatibility/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcompatibility%2Froute&page=%2Fapi%2Fcompatibility%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcompatibility%2Froute.ts&appDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fshaivirau%2FSkincare%2Fskin-check&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();